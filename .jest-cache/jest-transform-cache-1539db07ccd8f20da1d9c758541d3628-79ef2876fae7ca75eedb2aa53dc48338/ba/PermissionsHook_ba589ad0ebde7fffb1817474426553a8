781760313003a576b18f91b715a59fcd
'use client';

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.createPermissionHook = createPermissionHook;
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
var _objectWithoutProperties2 = _interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties"));
var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));
var _react = require("react");
var _excluded = ["get", "request"];
function usePermission(methods, options) {
  var isMounted = (0, _react.useRef)(true);
  var _useState = (0, _react.useState)(null),
    _useState2 = (0, _slicedToArray2.default)(_useState, 2),
    status = _useState2[0],
    setStatus = _useState2[1];
  var _ref = options || {},
    _ref$get = _ref.get,
    get = _ref$get === void 0 ? true : _ref$get,
    _ref$request = _ref.request,
    request = _ref$request === void 0 ? false : _ref$request,
    permissionOptions = (0, _objectWithoutProperties2.default)(_ref, _excluded);
  var getPermission = (0, _react.useCallback)((0, _asyncToGenerator2.default)(function* () {
    var response = yield methods.getMethod(Object.keys(permissionOptions).length > 0 ? permissionOptions : undefined);
    if (isMounted.current) setStatus(response);
    return response;
  }), [methods.getMethod]);
  var requestPermission = (0, _react.useCallback)((0, _asyncToGenerator2.default)(function* () {
    var response = yield methods.requestMethod(Object.keys(permissionOptions).length > 0 ? permissionOptions : undefined);
    if (isMounted.current) setStatus(response);
    return response;
  }), [methods.requestMethod]);
  (0, _react.useEffect)(function runMethods() {
    if (request) requestPermission();
    if (!request && get) getPermission();
  }, [get, request, requestPermission, getPermission]);
  (0, _react.useEffect)(function didMount() {
    isMounted.current = true;
    return function () {
      isMounted.current = false;
    };
  }, []);
  return [status, requestPermission, getPermission];
}
function createPermissionHook(methods) {
  return function (options) {
    return usePermission(methods, options);
  };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZXhwb3J0cyIsInZhbHVlIiwiY3JlYXRlUGVybWlzc2lvbkhvb2siLCJfYXN5bmNUb0dlbmVyYXRvcjIiLCJfb2JqZWN0V2l0aG91dFByb3BlcnRpZXMyIiwiX3NsaWNlZFRvQXJyYXkyIiwiX3JlYWN0IiwiX2V4Y2x1ZGVkIiwidXNlUGVybWlzc2lvbiIsIm1ldGhvZHMiLCJvcHRpb25zIiwiaXNNb3VudGVkIiwidXNlUmVmIiwiX3VzZVN0YXRlIiwidXNlU3RhdGUiLCJfdXNlU3RhdGUyIiwiZGVmYXVsdCIsInN0YXR1cyIsInNldFN0YXR1cyIsIl9yZWYiLCJfcmVmJGdldCIsImdldCIsIl9yZWYkcmVxdWVzdCIsInJlcXVlc3QiLCJwZXJtaXNzaW9uT3B0aW9ucyIsImdldFBlcm1pc3Npb24iLCJ1c2VDYWxsYmFjayIsInJlc3BvbnNlIiwiZ2V0TWV0aG9kIiwia2V5cyIsImxlbmd0aCIsInVuZGVmaW5lZCIsImN1cnJlbnQiLCJyZXF1ZXN0UGVybWlzc2lvbiIsInJlcXVlc3RNZXRob2QiLCJ1c2VFZmZlY3QiLCJydW5NZXRob2RzIiwiZGlkTW91bnQiXSwic291cmNlcyI6WyJQZXJtaXNzaW9uc0hvb2sudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IMKpIDIwMjQgNjUwIEluZHVzdHJpZXMuXG5cbid1c2UgY2xpZW50JztcblxuaW1wb3J0IHsgdXNlQ2FsbGJhY2ssIHVzZUVmZmVjdCwgdXNlUmVmLCB1c2VTdGF0ZSB9IGZyb20gJ3JlYWN0JztcblxuaW1wb3J0IHsgUGVybWlzc2lvblJlc3BvbnNlIH0gZnJvbSAnLi9QZXJtaXNzaW9uc0ludGVyZmFjZSc7XG5cbi8vIFRoZXNlIHR5cGVzIGFyZSBpZGVudGljYWwsIGJ1dCBpbXByb3ZlcyB0aGUgcmVhZGFiaWxpdHkgZm9yIHN1Z2dlc3Rpb25zIGluIGVkaXRvcnNcbnR5cGUgUmVxdWVzdFBlcm1pc3Npb25NZXRob2Q8UGVybWlzc2lvbiBleHRlbmRzIFBlcm1pc3Npb25SZXNwb25zZT4gPSAoKSA9PiBQcm9taXNlPFBlcm1pc3Npb24+O1xudHlwZSBHZXRQZXJtaXNzaW9uTWV0aG9kPFBlcm1pc3Npb24gZXh0ZW5kcyBQZXJtaXNzaW9uUmVzcG9uc2U+ID0gKCkgPT4gUHJvbWlzZTxQZXJtaXNzaW9uPjtcblxudHlwZSBQZXJtaXNzaW9uSG9va01ldGhvZHM8UGVybWlzc2lvbiBleHRlbmRzIFBlcm1pc3Npb25SZXNwb25zZSwgT3B0aW9ucyA9IG5ldmVyPiA9IHtcbiAgLyoqIFRoZSBwZXJtaXNzaW9uIG1ldGhvZCB0aGF0IHJlcXVlc3RzIHRoZSB1c2VyIHRvIGdyYW50IHBlcm1pc3Npb24uICovXG4gIHJlcXVlc3RNZXRob2Q6IChvcHRpb25zPzogT3B0aW9ucykgPT4gUHJvbWlzZTxQZXJtaXNzaW9uPjtcbiAgLyoqIFRoZSBwZXJtaXNzaW9uIG1ldGhvZCB0aGF0IG9ubHkgZmV0Y2hlcyB0aGUgY3VycmVudCBwZXJtaXNzaW9uIHN0YXR1cy4gKi9cbiAgZ2V0TWV0aG9kOiAob3B0aW9ucz86IE9wdGlvbnMpID0+IFByb21pc2U8UGVybWlzc2lvbj47XG59O1xuXG50eXBlIFBlcm1pc3Npb25Ib29rQmVoYXZpb3IgPSB7XG4gIC8qKiBJZiB0aGUgaG9vayBzaG91bGQgYXV0b21hdGljYWxseSBmZXRjaCB0aGUgY3VycmVudCBwZXJtaXNzaW9uIHN0YXR1cywgd2l0aG91dCBhc2tpbmcgdGhlIHVzZXIuICovXG4gIGdldD86IGJvb2xlYW47XG4gIC8qKiBJZiB0aGUgaG9vayBzaG91bGQgYXV0b21hdGljYWxseSByZXF1ZXN0IHRoZSB1c2VyIHRvIGdyYW50IHBlcm1pc3Npb24uICovXG4gIHJlcXVlc3Q/OiBib29sZWFuO1xufTtcblxuZXhwb3J0IHR5cGUgUGVybWlzc2lvbkhvb2tPcHRpb25zPE9wdGlvbnMgZXh0ZW5kcyBvYmplY3Q+ID0gUGVybWlzc2lvbkhvb2tCZWhhdmlvciAmIE9wdGlvbnM7XG5cbi8qKlxuICogR2V0IG9yIHJlcXVlc3QgcGVybWlzc2lvbiBmb3IgcHJvdGVjdGVkIGZ1bmN0aW9uYWxpdHkgd2l0aGluIHRoZSBhcHAuXG4gKiBJdCB1c2VzIHNlcGFyYXRlIHBlcm1pc3Npb24gcmVxdWVzdGVycyB0byBpbnRlcmFjdCB3aXRoIGEgc2luZ2xlIHBlcm1pc3Npb24uXG4gKiBCeSBkZWZhdWx0LCB0aGUgaG9vayB3aWxsIG9ubHkgcmV0cmlldmUgdGhlIHBlcm1pc3Npb24gc3RhdHVzLlxuICovXG5mdW5jdGlvbiB1c2VQZXJtaXNzaW9uPFBlcm1pc3Npb24gZXh0ZW5kcyBQZXJtaXNzaW9uUmVzcG9uc2UsIE9wdGlvbnMgZXh0ZW5kcyBvYmplY3Q+KFxuICBtZXRob2RzOiBQZXJtaXNzaW9uSG9va01ldGhvZHM8UGVybWlzc2lvbiwgT3B0aW9ucz4sXG4gIG9wdGlvbnM/OiBQZXJtaXNzaW9uSG9va09wdGlvbnM8T3B0aW9ucz5cbik6IFtQZXJtaXNzaW9uIHwgbnVsbCwgUmVxdWVzdFBlcm1pc3Npb25NZXRob2Q8UGVybWlzc2lvbj4sIEdldFBlcm1pc3Npb25NZXRob2Q8UGVybWlzc2lvbj5dIHtcbiAgY29uc3QgaXNNb3VudGVkID0gdXNlUmVmKHRydWUpO1xuICBjb25zdCBbc3RhdHVzLCBzZXRTdGF0dXNdID0gdXNlU3RhdGU8UGVybWlzc2lvbiB8IG51bGw+KG51bGwpO1xuICBjb25zdCB7IGdldCA9IHRydWUsIHJlcXVlc3QgPSBmYWxzZSwgLi4ucGVybWlzc2lvbk9wdGlvbnMgfSA9IG9wdGlvbnMgfHwge307XG5cbiAgY29uc3QgZ2V0UGVybWlzc2lvbiA9IHVzZUNhbGxiYWNrKGFzeW5jICgpID0+IHtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IG1ldGhvZHMuZ2V0TWV0aG9kKFxuICAgICAgT2JqZWN0LmtleXMocGVybWlzc2lvbk9wdGlvbnMpLmxlbmd0aCA+IDAgPyAocGVybWlzc2lvbk9wdGlvbnMgYXMgT3B0aW9ucykgOiB1bmRlZmluZWRcbiAgICApO1xuICAgIGlmIChpc01vdW50ZWQuY3VycmVudCkgc2V0U3RhdHVzKHJlc3BvbnNlKTtcbiAgICByZXR1cm4gcmVzcG9uc2U7XG4gIH0sIFttZXRob2RzLmdldE1ldGhvZF0pO1xuXG4gIGNvbnN0IHJlcXVlc3RQZXJtaXNzaW9uID0gdXNlQ2FsbGJhY2soYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgbWV0aG9kcy5yZXF1ZXN0TWV0aG9kKFxuICAgICAgT2JqZWN0LmtleXMocGVybWlzc2lvbk9wdGlvbnMpLmxlbmd0aCA+IDAgPyAocGVybWlzc2lvbk9wdGlvbnMgYXMgT3B0aW9ucykgOiB1bmRlZmluZWRcbiAgICApO1xuICAgIGlmIChpc01vdW50ZWQuY3VycmVudCkgc2V0U3RhdHVzKHJlc3BvbnNlKTtcbiAgICByZXR1cm4gcmVzcG9uc2U7XG4gIH0sIFttZXRob2RzLnJlcXVlc3RNZXRob2RdKTtcblxuICB1c2VFZmZlY3QoXG4gICAgZnVuY3Rpb24gcnVuTWV0aG9kcygpIHtcbiAgICAgIGlmIChyZXF1ZXN0KSByZXF1ZXN0UGVybWlzc2lvbigpO1xuICAgICAgaWYgKCFyZXF1ZXN0ICYmIGdldCkgZ2V0UGVybWlzc2lvbigpO1xuICAgIH0sXG4gICAgW2dldCwgcmVxdWVzdCwgcmVxdWVzdFBlcm1pc3Npb24sIGdldFBlcm1pc3Npb25dXG4gICk7XG5cbiAgLy8gV29ya2Fyb3VuZCBmb3IgdW5tb3VudGluZyBjb21wb25lbnRzIHJlY2VpdmluZyBzdGF0ZSB1cGRhdGVzXG4gIHVzZUVmZmVjdChmdW5jdGlvbiBkaWRNb3VudCgpIHtcbiAgICBpc01vdW50ZWQuY3VycmVudCA9IHRydWU7XG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIGlzTW91bnRlZC5jdXJyZW50ID0gZmFsc2U7XG4gICAgfTtcbiAgfSwgW10pO1xuXG4gIHJldHVybiBbc3RhdHVzLCByZXF1ZXN0UGVybWlzc2lvbiwgZ2V0UGVybWlzc2lvbl07XG59XG5cbi8qKlxuICogQ3JlYXRlIGEgbmV3IHBlcm1pc3Npb24gaG9vayB3aXRoIHRoZSBwZXJtaXNzaW9uIG1ldGhvZHMgYnVpbHQtaW4uXG4gKiBUaGlzIGNhbiBiZSB1c2VkIHRvIHF1aWNrbHkgY3JlYXRlIHNwZWNpZmljIHBlcm1pc3Npb24gaG9va3MgaW4gZXZlcnkgbW9kdWxlLlxuICovXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlUGVybWlzc2lvbkhvb2s8UGVybWlzc2lvbiBleHRlbmRzIFBlcm1pc3Npb25SZXNwb25zZSwgT3B0aW9ucyBleHRlbmRzIG9iamVjdD4oXG4gIG1ldGhvZHM6IFBlcm1pc3Npb25Ib29rTWV0aG9kczxQZXJtaXNzaW9uLCBPcHRpb25zPlxuKSB7XG4gIHJldHVybiAob3B0aW9ucz86IFBlcm1pc3Npb25Ib29rT3B0aW9uczxPcHRpb25zPikgPT5cbiAgICB1c2VQZXJtaXNzaW9uPFBlcm1pc3Npb24sIE9wdGlvbnM+KG1ldGhvZHMsIG9wdGlvbnMpO1xufVxuIl0sIm1hcHBpbmdzIjoiQUFFQSxZQUFZOztBQUFDLElBQUFBLHNCQUFBLEdBQUFDLE9BQUE7QUFBQUMsTUFBQSxDQUFBQyxjQUFBLENBQUFDLE9BQUE7RUFBQUMsS0FBQTtBQUFBO0FBQUFELE9BQUEsQ0FBQUUsb0JBQUEsR0FBQUEsb0JBQUE7QUFBQSxJQUFBQyxrQkFBQSxHQUFBUCxzQkFBQSxDQUFBQyxPQUFBO0FBQUEsSUFBQU8seUJBQUEsR0FBQVIsc0JBQUEsQ0FBQUMsT0FBQTtBQUFBLElBQUFRLGVBQUEsR0FBQVQsc0JBQUEsQ0FBQUMsT0FBQTtBQUViLElBQUFTLE1BQUEsR0FBQVQsT0FBQTtBQUFpRSxJQUFBVSxTQUFBO0FBNkJqRSxTQUFTQyxhQUFhQSxDQUNwQkMsT0FBbUQsRUFDbkRDLE9BQXdDLEVBQ21EO0VBQzNGLElBQU1DLFNBQVMsR0FBRyxJQUFBQyxhQUFNLEVBQUMsSUFBSSxDQUFDO0VBQzlCLElBQUFDLFNBQUEsR0FBNEIsSUFBQUMsZUFBUSxFQUFvQixJQUFJLENBQUM7SUFB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
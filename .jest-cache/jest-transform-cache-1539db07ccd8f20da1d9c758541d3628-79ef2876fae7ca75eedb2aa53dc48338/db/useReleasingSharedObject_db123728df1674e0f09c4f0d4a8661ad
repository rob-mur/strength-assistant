600f92d390269264f920546a4ceb7bdf
'use client';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.useReleasingSharedObject = useReleasingSharedObject;
var _react = require("react");
function useReleasingSharedObject(factory, dependencies) {
  var objectRef = (0, _react.useRef)(null);
  var isFastRefresh = (0, _react.useRef)(false);
  var previousDependencies = (0, _react.useRef)(dependencies);
  if (objectRef.current == null) {
    objectRef.current = factory();
  }
  var object = (0, _react.useMemo)(function () {
    var _previousDependencies;
    var newObject = objectRef.current;
    var dependenciesAreEqual = ((_previousDependencies = previousDependencies.current) == null ? void 0 : _previousDependencies.length) === dependencies.length && dependencies.every(function (value, index) {
      return value === previousDependencies.current[index];
    });
    if (!newObject || !dependenciesAreEqual) {
      var _objectRef$current;
      (_objectRef$current = objectRef.current) == null || _objectRef$current.release();
      newObject = factory();
      objectRef.current = newObject;
      previousDependencies.current = dependencies;
    } else {
      isFastRefresh.current = true;
    }
    return newObject;
  }, dependencies);
  (0, _react.useEffect)(function () {
    isFastRefresh.current = false;
    return function () {
      if (!isFastRefresh.current && objectRef.current) {
        objectRef.current.release();
      }
    };
  }, []);
  return object;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImV4cG9ydHMiLCJ2YWx1ZSIsInVzZVJlbGVhc2luZ1NoYXJlZE9iamVjdCIsIl9yZWFjdCIsInJlcXVpcmUiLCJmYWN0b3J5IiwiZGVwZW5kZW5jaWVzIiwib2JqZWN0UmVmIiwidXNlUmVmIiwiaXNGYXN0UmVmcmVzaCIsInByZXZpb3VzRGVwZW5kZW5jaWVzIiwiY3VycmVudCIsIm9iamVjdCIsInVzZU1lbW8iLCJfcHJldmlvdXNEZXBlbmRlbmNpZXMiLCJuZXdPYmplY3QiLCJkZXBlbmRlbmNpZXNBcmVFcXVhbCIsImxlbmd0aCIsImV2ZXJ5IiwiaW5kZXgiLCJfb2JqZWN0UmVmJGN1cnJlbnQiLCJyZWxlYXNlIiwidXNlRWZmZWN0Il0sInNvdXJjZXMiOlsidXNlUmVsZWFzaW5nU2hhcmVkT2JqZWN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2UgY2xpZW50JztcblxuaW1wb3J0IHsgRGVwZW5kZW5jeUxpc3QsIHVzZVJlZiwgdXNlTWVtbywgdXNlRWZmZWN0IH0gZnJvbSAncmVhY3QnO1xuXG5pbXBvcnQgdHlwZSB7IFNoYXJlZE9iamVjdCB9IGZyb20gJy4uL3RzLWRlY2xhcmF0aW9ucy9TaGFyZWRPYmplY3QnO1xuXG4vKipcbiAqIFJldHVybnMgYSBzaGFyZWQgb2JqZWN0LCB3aGljaCBpcyBhdXRvbWF0aWNhbGx5IGNsZWFuZWQgdXAgd2hlbiB0aGUgY29tcG9uZW50IGlzIHVubW91bnRlZC5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHVzZVJlbGVhc2luZ1NoYXJlZE9iamVjdDxUU2hhcmVkT2JqZWN0IGV4dGVuZHMgU2hhcmVkT2JqZWN0PihcbiAgZmFjdG9yeTogKCkgPT4gVFNoYXJlZE9iamVjdCxcbiAgZGVwZW5kZW5jaWVzOiBEZXBlbmRlbmN5TGlzdFxuKTogVFNoYXJlZE9iamVjdCB7XG4gIGNvbnN0IG9iamVjdFJlZiA9IHVzZVJlZjxUU2hhcmVkT2JqZWN0IHwgbnVsbD4obnVsbCk7XG4gIGNvbnN0IGlzRmFzdFJlZnJlc2ggPSB1c2VSZWYoZmFsc2UpO1xuICBjb25zdCBwcmV2aW91c0RlcGVuZGVuY2llcyA9IHVzZVJlZjxEZXBlbmRlbmN5TGlzdD4oZGVwZW5kZW5jaWVzKTtcblxuICBpZiAob2JqZWN0UmVmLmN1cnJlbnQgPT0gbnVsbCkge1xuICAgIG9iamVjdFJlZi5jdXJyZW50ID0gZmFjdG9yeSgpO1xuICB9XG5cbiAgY29uc3Qgb2JqZWN0ID0gdXNlTWVtbygoKSA9PiB7XG4gICAgbGV0IG5ld09iamVjdCA9IG9iamVjdFJlZi5jdXJyZW50O1xuICAgIGNvbnN0IGRlcGVuZGVuY2llc0FyZUVxdWFsID1cbiAgICAgIHByZXZpb3VzRGVwZW5kZW5jaWVzLmN1cnJlbnQ/Lmxlbmd0aCA9PT0gZGVwZW5kZW5jaWVzLmxlbmd0aCAmJlxuICAgICAgZGVwZW5kZW5jaWVzLmV2ZXJ5KCh2YWx1ZSwgaW5kZXgpID0+IHZhbHVlID09PSBwcmV2aW91c0RlcGVuZGVuY2llcy5jdXJyZW50W2luZGV4XSk7XG5cbiAgICAvLyBJZiB0aGUgZGVwZW5kZW5jaWVzIGhhdmUgY2hhbmdlZCwgcmVsZWFzZSB0aGUgcHJldmlvdXMgb2JqZWN0IGFuZCBjcmVhdGUgYSBuZXcgb25lLCBvdGhlcndpc2UgdGhpcyBoYXMgYmVlbiBjYWxsZWRcbiAgICAvLyBiZWNhdXNlIG9mIGEgZmFzdCByZWZyZXNoLCBhbmQgd2UgZG9uJ3Qgd2FudCB0byByZWxlYXNlIHRoZSBvYmplY3QuXG4gICAgaWYgKCFuZXdPYmplY3QgfHwgIWRlcGVuZGVuY2llc0FyZUVxdWFsKSB7XG4gICAgICBvYmplY3RSZWYuY3VycmVudD8ucmVsZWFzZSgpO1xuICAgICAgbmV3T2JqZWN0ID0gZmFjdG9yeSgpO1xuICAgICAgb2JqZWN0UmVmLmN1cnJlbnQgPSBuZXdPYmplY3Q7XG4gICAgICBwcmV2aW91c0RlcGVuZGVuY2llcy5jdXJyZW50ID0gZGVwZW5kZW5jaWVzO1xuICAgIH0gZWxzZSB7XG4gICAgICBpc0Zhc3RSZWZyZXNoLmN1cnJlbnQgPSB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gbmV3T2JqZWN0O1xuICB9LCBkZXBlbmRlbmNpZXMpO1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaXNGYXN0UmVmcmVzaC5jdXJyZW50ID0gZmFsc2U7XG5cbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgLy8gVGhpcyB3aWxsIGJlIGNhbGxlZCBvbiBldmVyeSBmYXN0IHJlZnJlc2ggYW5kIG9uIHVubW91bnQsIGJ1dCB3ZSBvbmx5IHdhbnQgdG8gcmVsZWFzZSB0aGUgb2JqZWN0IG9uIHVubW91bnQuXG4gICAgICBpZiAoIWlzRmFzdFJlZnJlc2guY3VycmVudCAmJiBvYmplY3RSZWYuY3VycmVudCkge1xuICAgICAgICBvYmplY3RSZWYuY3VycmVudC5yZWxlYXNlKCk7XG4gICAgICB9XG4gICAgfTtcbiAgfSwgW10pO1xuXG4gIHJldHVybiBvYmplY3Q7XG59XG4iXSwibWFwcGluZ3MiOiJBQUFBLFlBQVk7O0FBQUNBLE1BQUEsQ0FBQUMsY0FBQSxDQUFBQyxPQUFBO0VBQUFDLEtBQUE7QUFBQTtBQUFBRCxPQUFBLENBQUFFLHdCQUFBLEdBQUFBLHdCQUFBO0FBRWIsSUFBQUMsTUFBQSxHQUFBQyxPQUFBO0FBT08sU0FBU0Ysd0JBQXdCQSxDQUN0Q0csT0FBNEIsRUFDNUJDLFlBQTRCLEVBQ2I7RUFDZixJQUFNQyxTQUFTLEdBQUcsSUFBQUMsYUFBTSxFQUF1QixJQUFJLENBQUM7RUFDcEQsSUFBTUMsYUFBYSxHQUFHLElBQUFELGFBQU0sRUFBQyxLQUFLLENBQUM7RUFDbkMsSUFBTUUsb0JBQW9CLEdBQUcsSUFBQUYsYUFBTSxFQUFpQkYsWUFBWSxDQUFDO0VBRWpFLElBQUlDLFNBQVMsQ0FBQ0ksT0FBTyxJQUFJLElBQUksRUFBRTtJQUM3QkosU0FBUyxDQUFDSSxPQUFPLEdBQUdOLE9BQU8sQ0FBQyxDQUFDO0VBQy9CO0VBRUEsSUFBTU8sTUFBTSxHQUFHLElBQUFDLGNBQU8sRUFBQyxZQUFNO0lBQUEsSUFBQUMscUJBQUE7SUFDM0IsSUFBSUMsU0FBUyxHQUFHUixTQUFTLENBQUNJLE9BQU87SUFDakMsSUFBTUssb0JBQW9CLEdBQ3hCLEVBQUFGLHFCQUFBLEdBQUFKLG9CQUFvQixDQUFDQyxPQUFPLHFCQUE1QkcscUJBQUEsQ0FBOEJHLE1BQU0sTUFBS1gsWUFBWSxDQUFDVyxNQUFNLElBQzVEWCxZQUFZLENBQUNZLEtBQUssQ0FBQyxVQUFDakIsS0FBSyxFQUFFa0IsS0FBSztNQUFBLE9BQUtsQixLQUFLLEtBQUtTLG9CQUFvQixDQUFDQyxPQUFPLENBQUNRLEtBQUssQ0FBQztJQUFBLEVBQUM7SUFJckYsSUFBSSxDQUFDSixTQUFTLElBQUksQ0FBQ0Msb0JBQW9CLEVBQUU7TUFBQSxJQUFBSSxrQkFBQTtNQUN2QyxDQUFBQSxrQkFBQSxHQUFBYixTQUFTLENBQUNJLE9BQU8sYUFBakJTLGtCQUFBLENBQW1CQyxPQUFPLENBQUMsQ0FBQztNQUM1Qk4sU0FBUyxHQUFHVixPQUFPLENBQUMsQ0FBQztNQUNyQkUsU0FBUyxDQUFDSSxPQUFPLEdBQUdJLFNBQVM7TUFDN0JMLG9CQUFvQixDQUFDQyxPQUFPLEdBQUdMLFlBQVk7SUFDN0MsQ0FBQyxNQUFNO01BQ0xHLGFBQWEsQ0FBQ0UsT0FBTyxHQUFHLElBQUk7SUFDOUI7SUFDQSxPQUFPSSxTQUFTO0VBQ2xCLENBQUMsRUFBRVQsWUFBWSxDQUFDO0VBRWhCLElBQUFnQixnQkFBUyxFQUFDLFlBQU07SUFDZGIsYUFBYSxDQUFDRSxPQUFPLEdBQUcsS0FBSztJQUU3QixPQUFPLFlBQU07TUFFWCxJQUFJLENBQUNGLGFBQWEsQ0FBQ0UsT0FBTyxJQUFJSixTQUFTLENBQUNJLE9BQU8sRUFBRTtRQUMvQ0osU0FBUyxDQUFDSSxPQUFPLENBQUNVLE9BQU8sQ0FBQyxDQUFDO01BQzdCO0lBQ0YsQ0FBQztFQUNILENBQUMsRUFBRSxFQUFFLENBQUM7RUFFTixPQUFPVCxNQUFNO0FBQ2YiLCJpZ25vcmVMaXN0IjpbXX0=
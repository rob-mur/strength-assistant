appId: com.jimmysolutions.strengthassistant.test
---
# Test: Validate Airplane Mode Actually Works
# Purpose: Check if setAirplaneMode actually disconnects network in CI environment
# 
# This test determines if Maestro's setAirplaneMode command actually works
# in the current CI environment or if it's a false positive

- launchApp

# Handle authentication - continue as guest
- assertVisible:
    text: "Continue as Guest"
- tapOn:
    id: "continue-as-guest"

# Wait for app to load
- assertVisible:
    id: "workoutTab"

# Navigate to exercises to baseline sync state
- tapOn:
    id: "exercisesTab"
- assertVisible:
    id: "exercisesTab"

# BASELINE: Verify app is initially online
- assertVisible:
    id: "sync-status-synced"

# STEP 1: Enable airplane mode
- setAirplaneMode: enabled

# CRITICAL TEST: Does app actually detect offline state?
# If this assertion FAILS, then airplane mode is not really working
# (assertVisible automatically waits for the element to appear)
- assertVisible:
    id: "sync-status-offline"

# STEP 2: Try to create an exercise that would normally sync immediately
- tapOn:
    id: "add-exercise"
- tapOn:
    id: "name"
- inputText: "Airplane Mode Validation Test"
- tapOn:
    id: "submit"

# CRITICAL TEST: Exercise should NOT sync while airplane mode is active
# If app still shows "synced" then airplane mode is not working
- assertVisible:
    id: "sync-status-pending"

# STEP 3: Disable airplane mode
- setAirplaneMode: disabled

# CRITICAL TEST: App should detect network restoration
# (assertVisible automatically waits for the element to appear)
- assertVisible:
    id: "sync-status-synced"

# Clean up
- tapOn:
    text: "Airplane Mode Validation Test"
- tapOn:
    id: "delete-exercise-button"
- tapOn:
    text: "Delete"

# If this test PASSES, airplane mode is working correctly
# If this test FAILS, the CI environment has the emulator airplane mode bug
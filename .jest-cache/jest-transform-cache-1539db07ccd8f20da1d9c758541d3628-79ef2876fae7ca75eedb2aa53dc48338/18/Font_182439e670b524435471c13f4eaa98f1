c5a6f272de4ea1b2c3c36b02d4fafb82
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
Object.defineProperty(exports, "FontDisplay", {
  enumerable: true,
  get: function get() {
    return _Font.FontDisplay;
  }
});
exports.getLoadedFonts = getLoadedFonts;
exports.isLoaded = isLoaded;
exports.isLoading = isLoading;
exports.loadAsync = loadAsync;
exports.unloadAllAsync = unloadAllAsync;
exports.unloadAsync = unloadAsync;
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
var _expoModulesCore = require("expo-modules-core");
var _ExpoFontLoader = _interopRequireDefault(require("./ExpoFontLoader"));
var _Font = require("./Font.types");
var _FontLoader = require("./FontLoader");
var _memory = require("./memory");
var _server = require("./server");
function isLoaded(fontFamily) {
  if (_expoModulesCore.Platform.OS === 'web') {
    return (0, _memory.isLoadedInCache)(fontFamily) || !!_ExpoFontLoader.default.isLoaded(fontFamily);
  }
  return (0, _memory.isLoadedNative)(fontFamily);
}
function getLoadedFonts() {
  return _ExpoFontLoader.default.getLoadedFonts();
}
function isLoading(fontFamily) {
  return fontFamily in _memory.loadPromises;
}
function loadAsync(fontFamilyOrFontMap, source) {
  var isServer = _expoModulesCore.Platform.OS === 'web' && typeof window === 'undefined';
  if (typeof fontFamilyOrFontMap === 'object') {
    if (source) {
      return Promise.reject(new _expoModulesCore.CodedError(`ERR_FONT_API`, `No fontFamily can be used for the provided source: ${source}. The second argument of \`loadAsync()\` can only be used with a \`string\` value as the first argument.`));
    }
    var fontMap = fontFamilyOrFontMap;
    var names = Object.keys(fontMap);
    if (isServer) {
      names.map(function (name) {
        return (0, _server.registerStaticFont)(name, fontMap[name]);
      });
      return Promise.resolve();
    }
    return Promise.all(names.map(function (name) {
      return loadFontInNamespaceAsync(name, fontMap[name]);
    })).then(function () {});
  }
  if (isServer) {
    (0, _server.registerStaticFont)(fontFamilyOrFontMap, source);
    return Promise.resolve();
  }
  return loadFontInNamespaceAsync(fontFamilyOrFontMap, source);
}
function loadFontInNamespaceAsync(_x, _x2) {
  return _loadFontInNamespaceAsync.apply(this, arguments);
}
function _loadFontInNamespaceAsync() {
  _loadFontInNamespaceAsync = (0, _asyncToGenerator2.default)(function* (fontFamily, source) {
    if (!source) {
      throw new _expoModulesCore.CodedError(`ERR_FONT_SOURCE`, `Cannot load null or undefined font source: { "${fontFamily}": ${source} }. Expected asset of type \`FontSource\` for fontFamily of name: "${fontFamily}"`);
    }
    if (isLoaded(fontFamily)) {
      return;
    }
    if (_memory.loadPromises.hasOwnProperty(fontFamily)) {
      return _memory.loadPromises[fontFamily];
    }
    var asset = (0, _FontLoader.getAssetForSource)(source);
    _memory.loadPromises[fontFamily] = (0, _asyncToGenerator2.default)(function* () {
      try {
        yield (0, _FontLoader.loadSingleFontAsync)(fontFamily, asset);
        (0, _memory.markLoaded)(fontFamily);
      } finally {
        delete _memory.loadPromises[fontFamily];
      }
    })();
    yield _memory.loadPromises[fontFamily];
  });
  return _loadFontInNamespaceAsync.apply(this, arguments);
}
function unloadAllAsync() {
  return _unloadAllAsync.apply(this, arguments);
}
function _unloadAllAsync() {
  _unloadAllAsync = (0, _asyncToGenerator2.default)(function* () {
    if (!_ExpoFontLoader.default.unloadAllAsync) {
      throw new _expoModulesCore.UnavailabilityError('expo-font', 'unloadAllAsync');
    }
    if (Object.keys(_memory.loadPromises).length) {
      throw new _expoModulesCore.CodedError(`ERR_UNLOAD`, `Cannot unload fonts while they're still loading: ${Object.keys(_memory.loadPromises).join(', ')}`);
    }
    (0, _memory.purgeCache)();
    yield _ExpoFontLoader.default.unloadAllAsync();
  });
  return _unloadAllAsync.apply(this, arguments);
}
function unloadAsync(_x3, _x4) {
  return _unloadAsync.apply(this, arguments);
}
function _unloadAsync() {
  _unloadAsync = (0, _asyncToGenerator2.default)(function* (fontFamilyOrFontMap, options) {
    if (!_ExpoFontLoader.default.unloadAsync) {
      throw new _expoModulesCore.UnavailabilityError('expo-font', 'unloadAsync');
    }
    if (typeof fontFamilyOrFontMap === 'object') {
      if (options) {
        throw new _expoModulesCore.CodedError(`ERR_FONT_API`, `No fontFamily can be used for the provided options: ${options}. The second argument of \`unloadAsync()\` can only be used with a \`string\` value as the first argument.`);
      }
      var fontMap = fontFamilyOrFontMap;
      var names = Object.keys(fontMap);
      yield Promise.all(names.map(function (name) {
        return unloadFontInNamespaceAsync(name, fontMap[name]);
      }));
      return;
    }
    return yield unloadFontInNamespaceAsync(fontFamilyOrFontMap, options);
  });
  return _unloadAsync.apply(this, arguments);
}
function unloadFontInNamespaceAsync(_x5, _x6) {
  return _unloadFontInNamespaceAsync.apply(this, arguments);
}
function _unloadFontInNamespaceAsync() {
  _unloadFontInNamespaceAsync = (0, _asyncToGenerator2.default)(function* (fontFamily, options) {
    if (!isLoaded(fontFamily)) {
      return;
    } else {
      (0, _memory.purgeFontFamilyFromCache)(fontFamily);
    }
    if (!fontFamily) {
      throw new _expoModulesCore.CodedError(`ERR_FONT_FAMILY`, `Cannot unload an empty name`);
    }
    yield _ExpoFontLoader.default.unloadAsync(fontFamily, options);
  });
  return _unloadFontInNamespaceAsync.apply(this, arguments);
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZXhwb01vZHVsZXNDb3JlIiwicmVxdWlyZSIsIl9FeHBvRm9udExvYWRlciIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJfRm9udCIsIl9Gb250TG9hZGVyIiwiX21lbW9yeSIsIl9zZXJ2ZXIiLCJpc0xvYWRlZCIsImZvbnRGYW1pbHkiLCJQbGF0Zm9ybSIsIk9TIiwiaXNMb2FkZWRJbkNhY2hlIiwiRXhwb0ZvbnRMb2FkZXIiLCJpc0xvYWRlZE5hdGl2ZSIsImdldExvYWRlZEZvbnRzIiwiaXNMb2FkaW5nIiwibG9hZFByb21pc2VzIiwibG9hZEFzeW5jIiwiZm9udEZhbWlseU9yRm9udE1hcCIsInNvdXJjZSIsImlzU2VydmVyIiwid2luZG93IiwiUHJvbWlzZSIsInJlamVjdCIsIkNvZGVkRXJyb3IiLCJmb250TWFwIiwibmFtZXMiLCJPYmplY3QiLCJrZXlzIiwibWFwIiwibmFtZSIsInJlZ2lzdGVyU3RhdGljRm9udCIsInJlc29sdmUiLCJhbGwiLCJsb2FkRm9udEluTmFtZXNwYWNlQXN5bmMiLCJ0aGVuIiwiX3giLCJfeDIiLCJfbG9hZEZvbnRJbk5hbWVzcGFjZUFzeW5jIiwiYXBwbHkiLCJhcmd1bWVudHMiLCJfYXN5bmNUb0dlbmVyYXRvcjIiLCJkZWZhdWx0IiwiaGFzT3duUHJvcGVydHkiLCJhc3NldCIsImdldEFzc2V0Rm9yU291cmNlIiwibG9hZFNpbmdsZUZvbnRBc3luYyIsIm1hcmtMb2FkZWQiLCJ1bmxvYWRBbGxBc3luYyIsIl91bmxvYWRBbGxBc3luYyIsIlVuYXZhaWxhYmlsaXR5RXJyb3IiLCJsZW5ndGgiLCJqb2luIiwicHVyZ2VDYWNoZSIsInVubG9hZEFzeW5jIiwiX3gzIiwiX3g0IiwiX3VubG9hZEFzeW5jIiwib3B0aW9ucyIsInVubG9hZEZvbnRJbk5hbWVzcGFjZUFzeW5jIiwiX3g1IiwiX3g2IiwiX3VubG9hZEZvbnRJbk5hbWVzcGFjZUFzeW5jIiwicHVyZ2VGb250RmFtaWx5RnJvbUNhY2hlIl0sInNvdXJjZXMiOlsiLi4vc3JjL0ZvbnQudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29kZWRFcnJvciwgUGxhdGZvcm0sIFVuYXZhaWxhYmlsaXR5RXJyb3IgfSBmcm9tICdleHBvLW1vZHVsZXMtY29yZSc7XG5cbmltcG9ydCBFeHBvRm9udExvYWRlciBmcm9tICcuL0V4cG9Gb250TG9hZGVyJztcbmltcG9ydCB7IEZvbnREaXNwbGF5LCBGb250U291cmNlLCBGb250UmVzb3VyY2UsIFVubG9hZEZvbnRPcHRpb25zIH0gZnJvbSAnLi9Gb250LnR5cGVzJztcbmltcG9ydCB7IGdldEFzc2V0Rm9yU291cmNlLCBsb2FkU2luZ2xlRm9udEFzeW5jIH0gZnJvbSAnLi9Gb250TG9hZGVyJztcbmltcG9ydCB7XG4gIGlzTG9hZGVkSW5DYWNoZSxcbiAgaXNMb2FkZWROYXRpdmUsXG4gIGxvYWRQcm9taXNlcyxcbiAgbWFya0xvYWRlZCxcbiAgcHVyZ2VDYWNoZSxcbiAgcHVyZ2VGb250RmFtaWx5RnJvbUNhY2hlLFxufSBmcm9tICcuL21lbW9yeSc7XG5pbXBvcnQgeyByZWdpc3RlclN0YXRpY0ZvbnQgfSBmcm9tICcuL3NlcnZlcic7XG5cbi8vIEBuZWVkc0F1ZGl0XG4vKipcbiAqIFN5bmNocm9ub3VzbHkgZGV0ZWN0IGlmIHRoZSBmb250IGZvciBgZm9udEZhbWlseWAgaGFzIGZpbmlzaGVkIGxvYWRpbmcuXG4gKlxuICogQHBhcmFtIGZvbnRGYW1pbHkgVGhlIG5hbWUgdXNlZCB0byBsb2FkIHRoZSBgRm9udFJlc291cmNlYC5cbiAqIEByZXR1cm4gUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIGZvbnQgaGFzIGZ1bGx5IGxvYWRlZC5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzTG9hZGVkKGZvbnRGYW1pbHk6IHN0cmluZyk6IGJvb2xlYW4ge1xuICBpZiAoUGxhdGZvcm0uT1MgPT09ICd3ZWInKSB7XG4gICAgcmV0dXJuIGlzTG9hZGVkSW5DYWNoZShmb250RmFtaWx5KSB8fCAhIUV4cG9Gb250TG9hZGVyLmlzTG9hZGVkKGZvbnRGYW1pbHkpO1xuICB9XG4gIHJldHVybiBpc0xvYWRlZE5hdGl2ZShmb250RmFtaWx5KTtcbn1cblxuLyoqXG4gKiBTeW5jaHJvbm91c2x5IGdldCBhbGwgdGhlIGZvbnRzIHRoYXQgaGF2ZSBiZWVuIGxvYWRlZC5cbiAqIFRoaXMgaW5jbHVkZXMgZm9udHMgdGhhdCB3ZXJlIGJ1bmRsZWQgYXQgYnVpbGQgdGltZSB1c2luZyB0aGUgY29uZmlnIHBsdWdpbiwgYXMgd2VsbCBhcyB0aG9zZSBsb2FkZWQgYXQgcnVudGltZSB1c2luZyBgbG9hZEFzeW5jYC5cbiAqXG4gKiBAcmV0dXJucyBSZXR1cm5zIGFycmF5IG9mIHN0cmluZ3Mgd2hpY2ggeW91IGNhbiB1c2UgYXMgYGZvbnRGYW1pbHlgIFtzdHlsZSBwcm9wXShodHRwczovL3JlYWN0bmF0aXZlLmRldi9kb2NzL3RleHQjc3R5bGUpLlxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0TG9hZGVkRm9udHMoKTogc3RyaW5nW10ge1xuICByZXR1cm4gRXhwb0ZvbnRMb2FkZXIuZ2V0TG9hZGVkRm9udHMoKTtcbn1cblxuLy8gQG5lZWRzQXVkaXRcbi8qKlxuICogU3luY2hyb25vdXNseSBkZXRlY3QgaWYgdGhlIGZvbnQgZm9yIGBmb250RmFtaWx5YCBpcyBzdGlsbCBiZWluZyBsb2FkZWQuXG4gKlxuICogQHBhcmFtIGZvbnRGYW1pbHkgVGhlIG5hbWUgdXNlZCB0byBsb2FkIHRoZSBgRm9udFJlc291cmNlYC5cbiAqIEByZXR1cm5zIFJldHVybnMgYHRydWVgIGlmIHRoZSBmb250IGlzIHN0aWxsIGxvYWRpbmcuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0xvYWRpbmcoZm9udEZhbWlseTogc3RyaW5nKTogYm9vbGVhbiB7XG4gIHJldHVybiBmb250RmFtaWx5IGluIGxvYWRQcm9taXNlcztcbn1cblxuLy8gQG5lZWRzQXVkaXRcbi8qKlxuICogQW4gZWZmaWNpZW50IG1ldGhvZCBmb3IgbG9hZGluZyBmb250cyBmcm9tIHN0YXRpYyBvciByZW1vdGUgcmVzb3VyY2VzIHdoaWNoIGNhbiB0aGVuIGJlIHVzZWRcbiAqIHdpdGggdGhlIHBsYXRmb3JtJ3MgbmF0aXZlIHRleHQgZWxlbWVudHMuIEluIHRoZSBicm93c2VyLCB0aGlzIGdlbmVyYXRlcyBhIGBAZm9udC1mYWNlYCBibG9jayBpblxuICogYSBzaGFyZWQgc3R5bGUgc2hlZXQgZm9yIGZvbnRzLiBObyBDU1MgaXMgbmVlZGVkIHRvIHVzZSB0aGlzIG1ldGhvZC5cbiAqXG4gKiA+ICoqTm90ZSoqOiBXZSByZWNvbW1lbmQgdXNpbmcgdGhlIFtjb25maWcgcGx1Z2luXSgjY29uZmlndXJhdGlvbi1pbi1hcHBqc29uYXBwY29uZmlnanMpIGluc3RlYWQgd2hlbmV2ZXIgcG9zc2libGUuXG4gKlxuICogQHBhcmFtIGZvbnRGYW1pbHlPckZvbnRNYXAgU3RyaW5nIG9yIG1hcCBvZiB2YWx1ZXMgdGhhdCBjYW4gYmUgdXNlZCBhcyB0aGUgYGZvbnRGYW1pbHlgIFtzdHlsZSBwcm9wXShodHRwczovL3JlYWN0bmF0aXZlLmRldi9kb2NzL3RleHQjc3R5bGUpXG4gKiB3aXRoIFJlYWN0IE5hdGl2ZSBgVGV4dGAgZWxlbWVudHMuXG4gKiBAcGFyYW0gc291cmNlIFRoZSBmb250IGFzc2V0IHRoYXQgc2hvdWxkIGJlIGxvYWRlZCBpbnRvIHRoZSBgZm9udEZhbWlseWAgbmFtZXNwYWNlLlxuICpcbiAqIEByZXR1cm4gUmV0dXJucyBhIHByb21pc2UgdGhhdCBmdWxmaWxzIHdoZW4gdGhlIGZvbnQgaGFzIGxvYWRlZC4gT2Z0ZW4geW91IG1heSB3YW50IHRvIHdyYXAgdGhlXG4gKiBtZXRob2QgaW4gYSBgdHJ5L2NhdGNoL2ZpbmFsbHlgIHRvIGVuc3VyZSB0aGUgYXBwIGNvbnRpbnVlcyBpZiB0aGUgZm9udCBmYWlscyB0byBsb2FkLlxuICovXG5leHBvcnQgZnVuY3Rpb24gbG9hZEFzeW5jKFxuICBmb250RmFtaWx5T3JGb250TWFwOiBzdHJpbmcgfCBSZWNvcmQ8c3RyaW5nLCBGb250U291cmNlPixcbiAgc291cmNlPzogRm9udFNvdXJjZVxuKTogUHJvbWlzZTx2b2lkPiB7XG4gIC8vIE5PVEUoRXZhbkJhY29uKTogU3RhdGljIHJlbmRlciBwYXNzIG9uIHdlYiBtdXN0IGJlIHN5bmNocm9ub3VzIHRvIGNvbGxlY3QgYWxsIGZvbnRzLlxuICAvLyBCZWNhdXNlIG9mIHRoaXMsIGBsb2FkQXN5bmNgIGRvZXNuJ3QgdXNlIHRoZSBgYXN5bmNgIGtleXdvcmQgYW5kIGRldmlhdGVzIGZyb20gdGhlXG4gIC8vIHN0YW5kYXJkIEV4cG8gU0RLIHN0eWxlIGd1aWRlLlxuICBjb25zdCBpc1NlcnZlciA9IFBsYXRmb3JtLk9TID09PSAnd2ViJyAmJiB0eXBlb2Ygd2luZG93ID09PSAndW5kZWZpbmVkJztcblxuICBpZiAodHlwZW9mIGZvbnRGYW1pbHlPckZvbnRNYXAgPT09ICdvYmplY3QnKSB7XG4gICAgaWYgKHNvdXJjZSkge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KFxuICAgICAgICBuZXcgQ29kZWRFcnJvcihcbiAgICAgICAgICBgRVJSX0ZPTlRfQVBJYCxcbiAgICAgICAgICBgTm8gZm9udEZhbWlseSBjYW4gYmUgdXNlZCBmb3IgdGhlIHByb3ZpZGVkIHNvdXJjZTogJHtzb3VyY2V9LiBUaGUgc2Vjb25kIGFyZ3VtZW50IG9mIFxcYGxvYWRBc3luYygpXFxgIGNhbiBvbmx5IGJlIHVzZWQgd2l0aCBhIFxcYHN0cmluZ1xcYCB2YWx1ZSBhcyB0aGUgZmlyc3QgYXJndW1lbnQuYFxuICAgICAgICApXG4gICAgICApO1xuICAgIH1cbiAgICBjb25zdCBmb250TWFwID0gZm9udEZhbWlseU9yRm9udE1hcDtcbiAgICBjb25zdCBuYW1lcyA9IE9iamVjdC5rZXlzKGZvbnRNYXApO1xuXG4gICAgaWYgKGlzU2VydmVyKSB7XG4gICAgICBuYW1lcy5tYXAoKG5hbWUpID0+IHJlZ2lzdGVyU3RhdGljRm9udChuYW1lLCBmb250TWFwW25hbWVdKSk7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIFByb21pc2UuYWxsKG5hbWVzLm1hcCgobmFtZSkgPT4gbG9hZEZvbnRJbk5hbWVzcGFjZUFzeW5jKG5hbWUsIGZvbnRNYXBbbmFtZV0pKSkudGhlbihcbiAgICAgICgpID0+IHt9XG4gICAgKTtcbiAgfVxuXG4gIGlmIChpc1NlcnZlcikge1xuICAgIHJlZ2lzdGVyU3RhdGljRm9udChmb250RmFtaWx5T3JGb250TWFwLCBzb3VyY2UpO1xuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgfVxuXG4gIHJldHVybiBsb2FkRm9udEluTmFtZXNwYWNlQXN5bmMoZm9udEZhbWlseU9yRm9udE1hcCwgc291cmNlKTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gbG9hZEZvbnRJbk5hbWVzcGFjZUFzeW5jKFxuICBmb250RmFtaWx5OiBzdHJpbmcsXG4gIHNvdXJjZT86IEZvbnRTb3VyY2UgfCBudWxsXG4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgaWYgKCFzb3VyY2UpIHtcbiAgICB0aHJvdyBuZXcgQ29kZWRFcnJvcihcbiAgICAgIGBFUlJfRk9OVF9TT1VSQ0VgLFxuICAgICAgYENhbm5vdCBsb2FkIG51bGwgb3IgdW5kZWZpbmVkIGZvbnQgc291cmNlOiB7IFwiJHtmb250RmFtaWx5fVwiOiAke3NvdXJjZX0gfS4gRXhwZWN0ZWQgYXNzZXQgb2YgdHlwZSBcXGBGb250U291cmNlXFxgIGZvciBmb250RmFtaWx5IG9mIG5hbWU6IFwiJHtmb250RmFtaWx5fVwiYFxuICAgICk7XG4gIH1cblxuICAvLyB3ZSBjb25zdWx0IHRoZSBuYXRpdmUgbW9kdWxlIHRvIHNlZSBpZiB0aGUgZm9udCBpcyBhbHJlYWR5IGxvYWRlZFxuICAvLyB0aGlzIGlzIHNsb3dlciB0aGFuIGNoZWNraW5nIHRoZSBjYWNoZSBidXQgY2FuIGhlbHAgYXZvaWQgbG9hZGluZyB0aGUgc2FtZSBmb250IG4gdGltZXNcbiAgaWYgKGlzTG9hZGVkKGZvbnRGYW1pbHkpKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaWYgKGxvYWRQcm9taXNlcy5oYXNPd25Qcm9wZXJ0eShmb250RmFtaWx5KSkge1xuICAgIHJldHVybiBsb2FkUHJvbWlzZXNbZm9udEZhbWlseV07XG4gIH1cblxuICAvLyBJbXBvcnRhbnQ6IHdlIHdhbnQgYWxsIGNhbGxlcnMgdGhhdCBjb25jdXJyZW50bHkgdHJ5IHRvIGxvYWQgdGhlIHNhbWUgZm9udCB0byBhd2FpdCB0aGUgc2FtZVxuICAvLyBwcm9taXNlLiBJZiB3ZSdyZSBoZXJlLCB3ZSBoYXZlbid0IGNyZWF0ZWQgdGhlIHByb21pc2UgeWV0LiBUbyBlbnN1cmUgd2UgY3JlYXRlIG9ubHkgb25lXG4gIC8vIHByb21pc2UgaW4gdGhlIHByb2dyYW0sIHdlIG5lZWQgdG8gY3JlYXRlIHRoZSBwcm9taXNlIHN5bmNocm9ub3VzbHkgd2l0aG91dCB5aWVsZGluZyB0aGUgZXZlbnRcbiAgLy8gbG9vcCBmcm9tIHRoaXMgcG9pbnQuXG5cbiAgY29uc3QgYXNzZXQgPSBnZXRBc3NldEZvclNvdXJjZShzb3VyY2UpO1xuICBsb2FkUHJvbWlzZXNbZm9udEZhbWlseV0gPSAoYXN5bmMgKCkgPT4ge1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCBsb2FkU2luZ2xlRm9udEFzeW5jKGZvbnRGYW1pbHksIGFzc2V0KTtcbiAgICAgIG1hcmtMb2FkZWQoZm9udEZhbWlseSk7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIGRlbGV0ZSBsb2FkUHJvbWlzZXNbZm9udEZhbWlseV07XG4gICAgfVxuICB9KSgpO1xuXG4gIGF3YWl0IGxvYWRQcm9taXNlc1tmb250RmFtaWx5XTtcbn1cblxuLy8gQG5lZWRzQXVkaXRcbi8qKlxuICogVW5sb2FkcyBhbGwgdGhlIGN1c3RvbSBmb250cy4gVGhpcyBpcyB1c2VkIGZvciB0ZXN0aW5nLlxuICogQGhpZGRlblxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdW5sb2FkQWxsQXN5bmMoKTogUHJvbWlzZTx2b2lkPiB7XG4gIGlmICghRXhwb0ZvbnRMb2FkZXIudW5sb2FkQWxsQXN5bmMpIHtcbiAgICB0aHJvdyBuZXcgVW5hdmFpbGFiaWxpdHlFcnJvcignZXhwby1mb250JywgJ3VubG9hZEFsbEFzeW5jJyk7XG4gIH1cblxuICBpZiAoT2JqZWN0LmtleXMobG9hZFByb21pc2VzKS5sZW5ndGgpIHtcbiAgICB0aHJvdyBuZXcgQ29kZWRFcnJvcihcbiAgICAgIGBFUlJfVU5MT0FEYCxcbiAgICAgIGBDYW5ub3QgdW5sb2FkIGZvbnRzIHdoaWxlIHRoZXkncmUgc3RpbGwgbG9hZGluZzogJHtPYmplY3Qua2V5cyhsb2FkUHJvbWlzZXMpLmpvaW4oJywgJyl9YFxuICAgICk7XG4gIH1cbiAgcHVyZ2VDYWNoZSgpO1xuICBhd2FpdCBFeHBvRm9udExvYWRlci51bmxvYWRBbGxBc3luYygpO1xufVxuXG4vLyBAbmVlZHNBdWRpdFxuLyoqXG4gKiBVbmxvYWQgY3VzdG9tIGZvbnRzIG1hdGNoaW5nIHRoZSBgZm9udEZhbWlseWBzIGFuZCBkaXNwbGF5IHZhbHVlcyBwcm92aWRlZC5cbiAqIFRoaXMgaXMgdXNlZCBmb3IgdGVzdGluZy5cbiAqXG4gKiBAcGFyYW0gZm9udEZhbWlseU9yRm9udE1hcCBUaGUgbmFtZSBvciBuYW1lcyBvZiB0aGUgY3VzdG9tIGZvbnRzIHRoYXQgd2lsbCBiZSB1bmxvYWRlZC5cbiAqIEBwYXJhbSBvcHRpb25zIFdoZW4gYGZvbnRGYW1pbHlPckZvbnRNYXBgIGlzIGEgc3RyaW5nLCB0aGlzIHNob3VsZCBiZSB0aGUgZm9udCBzb3VyY2UgdXNlZCB0byBsb2FkXG4gKiB0aGUgY3VzdG9tIGZvbnQgb3JpZ2luYWxseS5cbiAqIEBoaWRkZW5cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVubG9hZEFzeW5jKFxuICBmb250RmFtaWx5T3JGb250TWFwOiBzdHJpbmcgfCBSZWNvcmQ8c3RyaW5nLCBVbmxvYWRGb250T3B0aW9ucz4sXG4gIG9wdGlvbnM/OiBVbmxvYWRGb250T3B0aW9uc1xuKTogUHJvbWlzZTx2b2lkPiB7XG4gIGlmICghRXhwb0ZvbnRMb2FkZXIudW5sb2FkQXN5bmMpIHtcbiAgICB0aHJvdyBuZXcgVW5hdmFpbGFiaWxpdHlFcnJvcignZXhwby1mb250JywgJ3VubG9hZEFzeW5jJyk7XG4gIH1cbiAgaWYgKHR5cGVvZiBmb250RmFtaWx5T3JGb250TWFwID09PSAnb2JqZWN0Jykge1xuICAgIGlmIChvcHRpb25zKSB7XG4gICAgICB0aHJvdyBuZXcgQ29kZWRFcnJvcihcbiAgICAgICAgYEVSUl9GT05UX0FQSWAsXG4gICAgICAgIGBObyBmb250RmFtaWx5IGNhbiBiZSB1c2VkIGZvciB0aGUgcHJvdmlkZWQgb3B0aW9uczogJHtvcHRpb25zfS4gVGhlIHNlY29uZCBhcmd1bWVudCBvZiBcXGB1bmxvYWRBc3luYygpXFxgIGNhbiBvbmx5IGJlIHVzZWQgd2l0aCBhIFxcYHN0cmluZ1xcYCB2YWx1ZSBhcyB0aGUgZmlyc3QgYXJndW1lbnQuYFxuICAgICAgKTtcbiAgICB9XG4gICAgY29uc3QgZm9udE1hcCA9IGZvbnRGYW1pbHlPckZvbnRNYXA7XG4gICAgY29uc3QgbmFtZXMgPSBPYmplY3Qua2V5cyhmb250TWFwKTtcbiAgICBhd2FpdCBQcm9taXNlLmFsbChuYW1lcy5tYXAoKG5hbWUpID0+IHVubG9hZEZvbnRJbk5hbWVzcGFjZUFzeW5jKG5hbWUsIGZvbnRNYXBbbmFtZV0pKSk7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgcmV0dXJuIGF3YWl0IHVubG9hZEZvbnRJbk5hbWVzcGFjZUFzeW5jKGZvbnRGYW1pbHlPckZvbnRNYXAsIG9wdGlvbnMpO1xufVxuXG5hc3luYyBmdW5jdGlvbiB1bmxvYWRGb250SW5OYW1lc3BhY2VBc3luYyhcbiAgZm9udEZhbWlseTogc3RyaW5nLFxuICBvcHRpb25zPzogVW5sb2FkRm9udE9wdGlvbnMgfCBudWxsXG4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgaWYgKCFpc0xvYWRlZChmb250RmFtaWx5KSkge1xuICAgIHJldHVybjtcbiAgfSBlbHNlIHtcbiAgICBwdXJnZUZvbnRGYW1pbHlGcm9tQ2FjaGUoZm9udEZhbWlseSk7XG4gIH1cblxuICAvLyBJbXBvcnRhbnQ6IHdlIHdhbnQgYWxsIGNhbGxlcnMgdGhhdCBjb25jdXJyZW50bHkgdHJ5IHRvIGxvYWQgdGhlIHNhbWUgZm9udCB0byBhd2FpdCB0aGUgc2FtZVxuICAvLyBwcm9taXNlLiBJZiB3ZSdyZSBoZXJlLCB3ZSBoYXZlbid0IGNyZWF0ZWQgdGhlIHByb21pc2UgeWV0LiBUbyBlbnN1cmUgd2UgY3JlYXRlIG9ubHkgb25lXG4gIC8vIHByb21pc2UgaW4gdGhlIHByb2dyYW0sIHdlIG5lZWQgdG8gY3JlYXRlIHRoZSBwcm9taXNlIHN5bmNocm9ub3VzbHkgd2l0aG91dCB5aWVsZGluZyB0aGUgZXZlbnRcbiAgLy8gbG9vcCBmcm9tIHRoaXMgcG9pbnQuXG5cbiAgaWYgKCFmb250RmFtaWx5KSB7XG4gICAgdGhyb3cgbmV3IENvZGVkRXJyb3IoYEVSUl9GT05UX0ZBTUlMWWAsIGBDYW5ub3QgdW5sb2FkIGFuIGVtcHR5IG5hbWVgKTtcbiAgfVxuXG4gIGF3YWl0IEV4cG9Gb250TG9hZGVyLnVubG9hZEFzeW5jKGZvbnRGYW1pbHksIG9wdGlvbnMpO1xufVxuXG5leHBvcnQgeyBGb250RGlzcGxheSwgRm9udFNvdXJjZSwgRm9udFJlc291cmNlLCBVbmxvYWRGb250T3B0aW9ucyB9O1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLElBQUFBLGdCQUFBLEdBQUFDLE9BQUE7QUFFQSxJQUFBQyxlQUFBLEdBQUFDLHNCQUFBLENBQUFGLE9BQUE7QUFDQSxJQUFBRyxLQUFBLEdBQUFILE9BQUE7QUFDQSxJQUFBSSxXQUFBLEdBQUFKLE9BQUE7QUFDQSxJQUFBSyxPQUFBLEdBQUFMLE9BQUE7QUFRQSxJQUFBTSxPQUFBLEdBQUFOLE9BQUE7QUFTTSxTQUFVTyxRQUFRQSxDQUFDQyxVQUFrQjtFQUN6QyxJQUFJQyx5QkFBUSxDQUFDQyxFQUFFLEtBQUssS0FBSyxFQUFFO0lB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
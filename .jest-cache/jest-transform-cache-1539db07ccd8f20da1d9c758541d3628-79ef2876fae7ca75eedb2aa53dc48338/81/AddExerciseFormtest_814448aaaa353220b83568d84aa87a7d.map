{"version":3,"names":["_getJestObj","mock","observable","jest","fn","observe","computed","virtual","initializeFirebaseServices","getDb","supabaseClient","getCurrentUser","exercises$","get","set","user$","syncExerciseToSupabase","deleteExerciseFromSupabase","syncHelpers","isSyncing","isOnline","getPendingChangesCount","forceSync","hasErrors","getErrorMessage","ExerciseValidator","validateExerciseInput","sanitizeExerciseName","collection","addDoc","deleteDoc","doc","onSnapshot","query","orderBy","v4","_interopRequireDefault","require","_asyncToGenerator2","_useAddExercise","_useAuth","_reactNative","_utils","_AddExerciseForm","_jsxRuntime","_require","mockUseAddExercise","mocked","useAddExercise","mockUseAuth","useAuth","describe","state","beforeEach","CommonTestState","mockReturnValue","_ref","default","_","_x","apply","arguments","user","uid","email","isAnonymous","loading","error","signInAnonymously","createAccount","signIn","signOut","clearError","test","render","jsx","type","screen","getByTestId","press","expect","lastCall","not","toBeNull","_submitButton$props$a","resolveAddExercise","addExercisePromise","Promise","resolve","_ref4","_x2","submitButton","props","accessibilityState","disabled","toBe","waitFor","_submitButton$props$a2"],"sources":["AddExerciseForm-test.tsx"],"sourcesContent":["import { useAddExercise } from \"@/lib/hooks/useAddExercise\";\nimport { useAuth } from \"@/lib/hooks/useAuth\";\nimport { render, screen, waitFor } from \"@testing-library/react-native\";\nimport { CommonTestState } from \"../../__test_utils__/utils\";\nimport AddExerciseForm from \"@/lib/components/Forms/AddExerciseForm\";\n\n// Mock dependencies first\njest.mock('@legendapp/state', () => ({\n  observable: jest.fn(),\n  observe: jest.fn(),\n  computed: jest.fn(),\n}), { virtual: true });\n\njest.mock('@/lib/data/firebase/initializer', () => ({\n  initializeFirebaseServices: jest.fn(),\n  getDb: jest.fn(),\n}));\n\njest.mock('@/lib/data/supabase/SupabaseClient', () => ({\n  supabaseClient: {\n    getCurrentUser: jest.fn(),\n  }\n}));\n\njest.mock('@/lib/data/store', () => ({\n  exercises$: {\n    get: jest.fn(),\n    set: jest.fn(),\n  },\n  user$: {\n    get: jest.fn(),\n  },\n}));\n\njest.mock('@/lib/data/sync/syncConfig', () => ({\n  syncExerciseToSupabase: jest.fn(),\n  deleteExerciseFromSupabase: jest.fn(),\n  syncHelpers: {\n    isSyncing: jest.fn(),\n    isOnline: jest.fn(),\n    getPendingChangesCount: jest.fn(),\n    forceSync: jest.fn(),\n    hasErrors: jest.fn(),\n    getErrorMessage: jest.fn(),\n  }\n}));\n\njest.mock('@/lib/models/Exercise', () => ({\n  ExerciseValidator: {\n    validateExerciseInput: jest.fn(),\n    sanitizeExerciseName: jest.fn(),\n  }\n}));\n\njest.mock('firebase/firestore', () => ({\n  collection: jest.fn(),\n  addDoc: jest.fn(),\n  deleteDoc: jest.fn(),\n  doc: jest.fn(),\n  onSnapshot: jest.fn(),\n  query: jest.fn(),\n  orderBy: jest.fn(),\n}));\n\njest.mock('uuid', () => ({\n  v4: jest.fn(() => 'test-uuid'),\n}));\n\njest.mock(\"expo-router\");\njest.mock(\"@/lib/data/firebase\");\njest.mock(\"@/lib/hooks/useAddExercise\");\njest.mock(\"@/lib/hooks/useAuth\");\nconst mockUseAddExercise = jest.mocked(useAddExercise);\nconst mockUseAuth = jest.mocked(useAuth);\n\ndescribe(\"<AddExerciseForm/>\", () => {\n  let state: CommonTestState;\n\n  beforeEach(() => {\n    state = new CommonTestState();\n    mockUseAddExercise.mockReturnValue(jest.fn(async (_) => {}));\n    mockUseAuth.mockReturnValue({\n      user: { uid: \"test-user-uid\", email: \"test@example.com\", isAnonymous: false },\n      loading: false,\n      error: null,\n      signInAnonymously: jest.fn(),\n      createAccount: jest.fn(),\n      signIn: jest.fn(),\n      signOut: jest.fn(),\n      clearError: jest.fn(),\n    });\n  });\n\n  test(\"When the user enters a name and pressed submit the callback is executed\", async () => {\n    // Given\n    render(<AddExerciseForm />);\n    // When\n    await state.user.type(screen.getByTestId(\"name\"), \"Exercise Name\");\n    await state.user.press(screen.getByTestId(\"submit\"));\n    // Then\n    expect(mockUseAddExercise.mock.lastCall).not.toBeNull();\n  });\n\n  test(\"Button is disabled and shows loading state during submission\", async () => {\n    // Given\n    let resolveAddExercise: () => void;\n    const addExercisePromise = new Promise<void>((resolve) => {\n      resolveAddExercise = resolve;\n    });\n    mockUseAddExercise.mockReturnValue(jest.fn(async (_) => {\n      await addExercisePromise;\n    }));\n    \n    render(<AddExerciseForm />);\n    const submitButton = screen.getByTestId(\"submit\");\n    \n    // When\n    await state.user.type(screen.getByTestId(\"name\"), \"Exercise Name\");\n    await state.user.press(submitButton);\n    \n    // Then - button should be disabled during loading\n    expect(submitButton.props.accessibilityState?.disabled).toBe(true);\n    \n    // Resolve the promise to complete the operation\n    resolveAddExercise!();\n    \n    // Wait for the loading state to clear\n    await waitFor(() => {\n      expect(submitButton.props.accessibilityState?.disabled).toBe(false);\n    });\n  });\n});\n"],"mappings":"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","ignoreList":[]}
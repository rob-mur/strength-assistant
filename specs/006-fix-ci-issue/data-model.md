# Phase 1 Data Model: Production Build Workflow Fix

## Entities

### ProductionBuildWorkflow

**Purpose**: GitHub Actions workflow that builds production APKs and creates releases
**Fields**:

- `trigger_events`: push to main, workflow_dispatch
- `jobs`: build (single job for APK creation and release)
- `validation_requirements`: none (removed invalid validation step)
- `output_artifacts`: production APK, GitHub release

**Validation Rules**:

- Must trigger on push to main branch
- Must support manual triggering via workflow_dispatch
- Must not include validation steps that reference non-existent commands
- Must maintain EXPO_TOKEN environment variable access

**State Transitions**:

1. Triggered → Running Build
2. Running Build → Creating Release (if build succeeds) OR Failed
3. Creating Release → Complete

### WorkflowJob

**Purpose**: Individual job within the production build workflow
**Fields**:

- `job_name`: build (only job after removing validate-main)
- `dependencies`: none (direct execution)
- `runner`: ubuntu-latest
- `environment`: Dev
- `steps`: checkout, android-build action, create-release

**Validation Rules**:

- Must not depend on removed validate-main job
- Must execute build and release steps in sequence
- Must use existing android-build action without modification

### GitHubRelease

**Purpose**: Release artifact created by production build
**Fields**:

- `tag_name`: v${{ github.run_number }}
- `release_name`: Release v${{ github.run_number }}
- `release_body`: commit information and build status
- `attached_files`: production APK file

**Validation Rules**:

- Must be created after successful APK build
- Must include APK file as attachment
- Must use consistent naming convention

## Relationships

- ProductionBuildWorkflow contains single WorkflowJob (1:1 after simplification)
- WorkflowJob creates GitHubRelease upon successful completion (1:1)
- GitHubRelease includes APK artifact generated by build process (1:1)

## Data Flow

1. **Trigger Event**: Push to main or manual workflow_dispatch
2. **Job Execution**: Single build job runs without validation dependencies
3. **APK Build**: android-build action creates production APK
4. **Release Creation**: GitHub release created with APK attachment
5. **Completion**: Workflow completes successfully without validation gate failures

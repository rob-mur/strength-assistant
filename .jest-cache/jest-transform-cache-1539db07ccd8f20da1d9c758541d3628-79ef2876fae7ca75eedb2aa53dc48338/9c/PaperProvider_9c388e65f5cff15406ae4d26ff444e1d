cbfd439d79bf61c2e36d01b71e7b31c7
"use strict";

var _interopRequireDefault2 = require("@babel/runtime/helpers/interopRequireDefault");
var _slicedToArray2 = _interopRequireDefault2(require("@babel/runtime/helpers/slicedToArray"));
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var React = _interopRequireWildcard(require("react"));
var _reactNative = require("react-native");
var _SafeAreaProviderCompat = _interopRequireDefault(require("./SafeAreaProviderCompat"));
var _settings = require("./settings");
var _theming = require("./theming");
var _MaterialCommunityIcon = _interopRequireDefault(require("../components/MaterialCommunityIcon"));
var _PortalHost = _interopRequireDefault(require("../components/Portal/PortalHost"));
var _addEventListener = require("../utils/addEventListener");
function _interopRequireDefault(e) {
  return e && e.__esModule ? e : {
    default: e
  };
}
function _interopRequireWildcard(e, t) {
  if ("function" == typeof WeakMap) var r = new WeakMap(),
    n = new WeakMap();
  return (_interopRequireWildcard = function _interopRequireWildcard(e, t) {
    if (!t && e && e.__esModule) return e;
    var o,
      i,
      f = {
        __proto__: null,
        default: e
      };
    if (null === e || "object" != typeof e && "function" != typeof e) return f;
    if (o = t ? n : r) {
      if (o.has(e)) return o.get(e);
      o.set(e, f);
    }
    for (var _t in e) "default" !== _t && {}.hasOwnProperty.call(e, _t) && ((i = (o = Object.defineProperty) && Object.getOwnPropertyDescriptor(e, _t)) && (i.get || i.set) ? o(f, _t, i) : f[_t] = e[_t]);
    return f;
  })(e, t);
}
var PaperProvider = function PaperProvider(props) {
  var isOnlyVersionInTheme = props.theme && Object.keys(props.theme).length === 1 && props.theme.version;
  var colorSchemeName = (!props.theme || isOnlyVersionInTheme) && (_reactNative.Appearance === null || _reactNative.Appearance === void 0 ? void 0 : _reactNative.Appearance.getColorScheme()) || 'light';
  var _React$useState = React.useState(false),
    _React$useState2 = (0, _slicedToArray2.default)(_React$useState, 2),
    reduceMotionEnabled = _React$useState2[0],
    setReduceMotionEnabled = _React$useState2[1];
  var _React$useState3 = React.useState(colorSchemeName),
    _React$useState4 = (0, _slicedToArray2.default)(_React$useState3, 2),
    colorScheme = _React$useState4[0],
    setColorScheme = _React$useState4[1];
  var handleAppearanceChange = function handleAppearanceChange(preferences) {
    var colorScheme = preferences.colorScheme;
    setColorScheme(colorScheme);
  };
  React.useEffect(function () {
    var subscription;
    if (!props.theme) {
      subscription = (0, _addEventListener.addEventListener)(_reactNative.AccessibilityInfo, 'reduceMotionChanged', setReduceMotionEnabled);
    }
    return function () {
      if (!props.theme) {
        var _subscription;
        (_subscription = subscription) === null || _subscription === void 0 || _subscription.remove();
      }
    };
  }, [props.theme]);
  React.useEffect(function () {
    var appearanceSubscription;
    if (!props.theme || isOnlyVersionInTheme) {
      appearanceSubscription = _reactNative.Appearance === null || _reactNative.Appearance === void 0 ? void 0 : _reactNative.Appearance.addChangeListener(handleAppearanceChange);
    }
    return function () {
      if (!props.theme || isOnlyVersionInTheme) {
        if (appearanceSubscription) {
          appearanceSubscription.remove();
        } else {
          _reactNative.Appearance === null || _reactNative.Appearance === void 0 || _reactNative.Appearance.removeChangeListener(handleAppearanceChange);
        }
      }
    };
  }, [props.theme, isOnlyVersionInTheme]);
  var theme = React.useMemo(function () {
    var _props$theme, _props$theme2;
    var themeVersion = ((_props$theme = props.theme) === null || _props$theme === void 0 ? void 0 : _props$theme.version) || 3;
    var scheme = colorScheme || 'light';
    var defaultThemeBase = _theming.defaultThemesByVersion[themeVersion][scheme];
    var extendedThemeBase = Object.assign({}, defaultThemeBase, props.theme, {
      version: themeVersion,
      animation: Object.assign({}, (_props$theme2 = props.theme) === null || _props$theme2 === void 0 ? void 0 : _props$theme2.animation, {
        scale: reduceMotionEnabled ? 0 : 1
      })
    });
    return Object.assign({}, extendedThemeBase, {
      isV3: extendedThemeBase.version === 3
    });
  }, [colorScheme, props.theme, reduceMotionEnabled]);
  var children = props.children,
    settings = props.settings;
  var settingsValue = React.useMemo(function () {
    return Object.assign({
      icon: _MaterialCommunityIcon.default,
      rippleEffectEnabled: true
    }, settings);
  }, [settings]);
  return React.createElement(_SafeAreaProviderCompat.default, null, React.createElement(_PortalHost.default, null, React.createElement(_settings.Provider, {
    value: settingsValue
  }, React.createElement(_theming.ThemeProvider, {
    theme: theme
  }, children))));
};
var _default = exports.default = PaperProvider;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJSZWFjdCIsIl9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkIiwicmVxdWlyZSIsIl9yZWFjdE5hdGl2ZSIsIl9TYWZlQXJlYVByb3ZpZGVyQ29tcGF0IiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsIl9zZXR0aW5ncyIsIl90aGVtaW5nIiwiX01hdGVyaWFsQ29tbXVuaXR5SWNvbiIsIl9Qb3J0YWxIb3N0IiwiX2FkZEV2ZW50TGlzdGVuZXIiLCJlIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJ0IiwiV2Vha01hcCIsInIiLCJuIiwibyIsImkiLCJmIiwiX19wcm90b19fIiwiaGFzIiwiZ2V0Iiwic2V0IiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IiLCJQYXBlclByb3ZpZGVyIiwicHJvcHMiLCJpc09ubHlWZXJzaW9uSW5UaGVtZSIsInRoZW1lIiwia2V5cyIsImxlbmd0aCIsInZlcnNpb24iLCJjb2xvclNjaGVtZU5hbWUiLCJBcHBlYXJhbmNlIiwiZ2V0Q29sb3JTY2hlbWUiLCJfUmVhY3QkdXNlU3RhdGUiLCJ1c2VTdGF0ZSIsIl9SZWFjdCR1c2VTdGF0ZTIiLCJfc2xpY2VkVG9BcnJheTIiLCJyZWR1Y2VNb3Rpb25FbmFibGVkIiwic2V0UmVkdWNlTW90aW9uRW5hYmxlZCIsIl9SZWFjdCR1c2VTdGF0ZTMiLCJfUmVhY3QkdXNlU3RhdGU0IiwiY29sb3JTY2hlbWUiLCJzZXRDb2xvclNjaGVtZSIsImhhbmRsZUFwcGVhcmFuY2VDaGFuZ2UiLCJwcmVmZXJlbmNlcyIsInVzZUVmZmVjdCIsInN1YnNjcmlwdGlvbiIsImFkZEV2ZW50TGlzdGVuZXIiLCJBY2Nlc3NpYmlsaXR5SW5mbyIsIl9zdWJzY3JpcHRpb24iLCJyZW1vdmUiLCJhcHBlYXJhbmNlU3Vic2NyaXB0aW9uIiwiYWRkQ2hhbmdlTGlzdGVuZXIiLCJyZW1vdmVDaGFuZ2VMaXN0ZW5lciIsInVzZU1lbW8iLCJfcHJvcHMkdGhlbWUiLCJfcHJvcHMkdGhlbWUyIiwidGhlbWVWZXJzaW9uIiwic2NoZW1lIiwiZGVmYXVsdFRoZW1lQmFzZSIsImRlZmF1bHRUaGVtZXNCeVZlcnNpb24iLCJleHRlbmRlZFRoZW1lQmFzZSIsImFzc2lnbiIsImFuaW1hdGlvbiIsInNjYWxlIiwiaXNWMyIsImNoaWxkcmVuIiwic2V0dGluZ3MiLCJzZXR0aW5nc1ZhbHVlIiwiaWNvbiIsInJpcHBsZUVmZmVjdEVuYWJsZWQiLCJjcmVhdGVFbGVtZW50IiwiUHJvdmlkZXIiLCJ2YWx1ZSIsIlRoZW1lUHJvdmlkZXIiLCJfZGVmYXVsdCIsImV4cG9ydHMiXSwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvY29yZS9QYXBlclByb3ZpZGVyLnRzeCJdLCJzb3VyY2VzQ29udGVudCI6W251bGxdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBQSxJQUFBQSxLQUFBLEdBQUFDLHVCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxZQUFBLEdBQUFELE9BQUE7QUFPQSxJQUFBRSx1QkFBQSxHQUFBQyxzQkFBQSxDQUFBSCxPQUFBO0FBQ0EsSUFBQUksU0FBQSxHQUFBSixPQUFBO0FBQ0EsSUFBQUssUUFBQSxHQUFBTCxPQUFBO0FBQ0EsSUFBQU0sc0JBQUEsR0FBQUgsc0JBQUEsQ0FBQUgsT0FBQTtBQUNBLElBQUFPLFdBQUEsR0FBQUosc0JBQUEsQ0FBQUgsT0FBQTtBQUVBLElBQUFRLGlCQUFBLEdBQUFSLE9BQUE7QUFBNkQsU0FBQUcsdUJBQUFNLENBQUE7RUFBQSxPQUFBQSxDQUFBLElBQUFBLENBQUEsQ0FBQUMsVUFBQSxHQUFBRCxDQUFBO0lBQUFFLE9BQUEsRUFBQUY7RUFBQTtBQUFBO0FBQUEsU0FBQVYsd0JBQUFVLENBQUEsRUFBQUcsQ0FBQTtFQUFBLHlCQUFBQyxPQUFBLE1BQUFDLENBQUEsT0FBQUQsT0FBQTtJQUFBRSxDQUFBLE9BQUFGLE9BQUE7RUFBQSxRQUFBZCx1QkFBQSxZQUFBQSx3QkFBQVUsQ0FBQSxFQUFBRyxDQUFBO0lB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SUFBTWtCLGdCQUFnQixHQUFHM0QsUUFBQSxDQUFBNEQsc0JBQXNCLENBQUNILFlBQVksQ0FBQyxDQUFDQyxNQUFNLENBQUM7SUFFckUsSUFBTUcsaUJBQWlCLEdBQUF6QyxNQUFBLENBQUEwQyxNQUFBLEtBQ2xCSCxnQkFBZ0IsRUFDaEJuQyxLQUFLLENBQUNFLEtBQUs7TUFDZEcsT0FBTyxFQUFFNEIsWUFBWTtNQUNyQk0sU0FBUyxFQUFBM0MsTUFBQSxDQUFBMEMsTUFBQSxLQUNQLENBQUFOLGFBQUEsR0FBR2hDLEtBQUssQ0FBQ0UsS0FBSyxjQUFBOEIsYUFBQSx1QkFBWEEsYUFBQSxDQUFhTyxTQUFTO1FBQ3pCQyxLQUFLLEVBQUUzQixtQkFBbUIsR0FBRyxDQUFDLEdBQUc7TUFBQTtJQUNuQyxFQUNEO0lBRUQsT0FBQWpCLE1BQUEsQ0FBQTBDLE1BQUEsS0FDS0QsaUJBQWlCO01BQ3BCSSxJQUFJLEVBQUVKLGlCQUFpQixDQUFDaEMsT0FBTyxLQUFLO0lBQUE7RUFFeEMsQ0FBQyxFQUFFLENBQUNZLFdBQVcsRUFBRWpCLEtBQUssQ0FBQ0UsS0FBSyxFQUFFVyxtQkFBbUIsQ0FBQyxDQUFDO0VBRW5ELElBQVE2QixRQUFRLEdBQWUxQyxLQUFLLENBQTVCMEMsUUFBUTtJQUFFQyxRQUFBLEdBQWEzQyxLQUFLLENBQWxCMkMsUUFBQTtFQUVsQixJQUFNQyxhQUFhLEdBQUczRSxLQUFLLENBQUM2RCxPQUFPLENBQ2pDO0lBQUEsT0FBQWxDLE1BQUEsQ0FBQTBDLE1BQUE7TUFDRU8sSUFBSSxFQUFFcEUsc0JBQUEsQ0FBQUssT0FBcUI7TUFDM0JnRSxtQkFBbUIsRUFBRTtJQUFJLEdBQ3RCSCxRQUFBO0VBQUEsQ0FDSCxFQUNGLENBQUNBLFFBQVEsQ0FDWCxDQUFDO0VBRUQsT0FDRTFFLEtBQUEsQ0FBQThFLGFBQUEsQ0FBQzFFLHVCQUFBLENBQUFTLE9BQXNCLFFBQ3JCYixLQUFBLENBQUE4RSxhQUFBLENBQUNyRSxXQUFBLENBQUFJLE9BQVUsUUFDVGIsS0FBQSxDQUFBOEUsYUFBQSxDQUFDeEUsU0FBQSxDQUFBeUUsUUFBZ0I7SUFBQ0MsS0FBSyxFQUFFTDtFQUFjLEdBQ3JDM0UsS0FBQSxDQUFBOEUsYUFBQSxDQUFDdkUsUUFBQSxDQUFBMEUsYUFBYTtJQUFDaEQsS0FBSyxFQUFFQTtFQUFNLEdBQUV3QyxRQUF3QixDQUN0QyxDQUNSLENBQ1UsQ0FBQztBQUU3QixDQUFDO0FBQUMsSUFBQVMsUUFBQSxHQUFBQyxPQUFBLENBQUF0RSxPQUFBLEdBRWFpQixhQUFhIiwiaWdub3JlTGlzdCI6W119
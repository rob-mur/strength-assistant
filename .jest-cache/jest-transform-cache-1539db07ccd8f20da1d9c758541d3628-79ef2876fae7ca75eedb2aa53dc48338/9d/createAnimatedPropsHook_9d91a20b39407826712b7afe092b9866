048eaa036444fba21fa943f22bd7802f
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = createAnimatedPropsHook;
var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));
var _AnimatedEvent = require("../../../Libraries/Animated/AnimatedEvent");
var _AnimatedNode = _interopRequireDefault(require("../../../Libraries/Animated/nodes/AnimatedNode"));
var _AnimatedProps = _interopRequireDefault(require("../../../Libraries/Animated/nodes/AnimatedProps"));
var _AnimatedValue = _interopRequireDefault(require("../../../Libraries/Animated/nodes/AnimatedValue"));
var _ReactFabricPublicInstanceUtils = require("../../../Libraries/ReactNative/ReactFabricPublicInstance/ReactFabricPublicInstanceUtils");
var _useRefEffect = _interopRequireDefault(require("../../../Libraries/Utilities/useRefEffect"));
var ReactNativeFeatureFlags = _interopRequireWildcard(require("../featureflags/ReactNativeFeatureFlags"));
var _createAnimatedPropsMemoHook = require("./createAnimatedPropsMemoHook");
var _NativeAnimatedHelper = _interopRequireDefault(require("./NativeAnimatedHelper"));
var _react = require("react");
function _interopRequireWildcard(e, t) { if ("function" == typeof WeakMap) var r = new WeakMap(), n = new WeakMap(); return (_interopRequireWildcard = function _interopRequireWildcard(e, t) { if (!t && e && e.__esModule) return e; var o, i, f = { __proto__: null, default: e }; if (null === e || "object" != typeof e && "function" != typeof e) return f; if (o = t ? n : r) { if (o.has(e)) return o.get(e); o.set(e, f); } for (var _t in e) "default" !== _t && {}.hasOwnProperty.call(e, _t) && ((i = (o = Object.defineProperty) && Object.getOwnPropertyDescriptor(e, _t)) && (i.get || i.set) ? o(f, _t, i) : f[_t] = e[_t]); return f; })(e, t); }
function createAnimatedPropsHook(allowlist) {
  var useAnimatedPropsMemo = (0, _createAnimatedPropsMemoHook.createAnimatedPropsMemoHook)(allowlist);
  return function useAnimatedProps(props) {
    var _useReducer = (0, _react.useReducer)(function (count) {
        return count + 1;
      }, 0),
      _useReducer2 = (0, _slicedToArray2.default)(_useReducer, 2),
      scheduleUpdate = _useReducer2[1];
    var onUpdateRef = (0, _react.useRef)(null);
    var timerRef = (0, _react.useRef)(null);
    var node = useAnimatedPropsMemo(function () {
      return new _AnimatedProps.default(props, function () {
        return onUpdateRef.current == null ? void 0 : onUpdateRef.current();
      }, allowlist);
    }, props);
    var useNativePropsInFabric = ReactNativeFeatureFlags.shouldUseSetNativePropsInFabric();
    (0, _react.useEffect)(function () {
      _NativeAnimatedHelper.default.API.flushQueue();
      var drivenAnimationEndedListener = null;
      if (node.__isNative) {
        drivenAnimationEndedListener = _NativeAnimatedHelper.default.nativeEventEmitter.addListener('onUserDrivenAnimationEnded', function (data) {
          node.update();
        });
      }
      return function () {
        var _drivenAnimationEnded;
        (_drivenAnimationEnded = drivenAnimationEndedListener) == null || _drivenAnimationEnded.remove();
      };
    });
    var useAnimatedPropsLifecycle = ReactNativeFeatureFlags.scheduleAnimatedCleanupInMicrotask() ? useAnimatedPropsLifecycleWithCleanupInMicrotask : useAnimatedPropsLifecycleWithPrevNodeRef;
    useAnimatedPropsLifecycle(node);
    var refEffect = (0, _react.useCallback)(function (instance) {
      node.setNativeView(instance);
      onUpdateRef.current = function () {
        if (process.env.NODE_ENV === 'test') {
          return scheduleUpdate();
        }
        var isFabricNode = isFabricInstance(instance);
        if (node.__isNative) {
          if (isFabricNode) {
            scheduleUpdate();
          }
          return;
        }
        if (typeof instance !== 'object' || typeof (instance == null ? void 0 : instance.setNativeProps) !== 'function') {
          return scheduleUpdate();
        }
        if (!isFabricNode) {
          return instance.setNativeProps(node.__getAnimatedValue());
        }
        if (!useNativePropsInFabric) {
          return scheduleUpdate();
        }
        instance.setNativeProps(node.__getAnimatedValue());
        if (timerRef.current != null) {
          clearTimeout(timerRef.current);
        }
        timerRef.current = setTimeout(function () {
          timerRef.current = null;
          scheduleUpdate();
        }, 48);
      };
      var target = getEventTarget(instance);
      var events = [];
      var animatedValueListeners = [];
      for (var propName in props) {
        var propValue = props[propName];
        if (propValue instanceof _AnimatedEvent.AnimatedEvent && propValue.__isNative) {
          propValue.__attach(target, propName);
          events.push([propName, propValue]);
          addListenersToPropsValue(propValue, animatedValueListeners);
        }
      }
      return function () {
        onUpdateRef.current = null;
        for (var _ref of events) {
          var _ref2 = (0, _slicedToArray2.default)(_ref, 2);
          var _propName = _ref2[0];
          var _propValue = _ref2[1];
          _propValue.__detach(target, _propName);
        }
        for (var _ref3 of animatedValueListeners) {
          var _propValue2 = _ref3.propValue;
          var listenerId = _ref3.listenerId;
          _propValue2.removeListener(listenerId);
        }
      };
    }, [node, useNativePropsInFabric, props]);
    var callbackRef = (0, _useRefEffect.default)(refEffect);
    return [reduceAnimatedProps(node, props), callbackRef];
  };
}
function reduceAnimatedProps(node, props) {
  return Object.assign({}, node.__getValueWithStaticProps(props), {
    collapsable: false
  });
}
function addListenersToPropsValue(propValue, accumulator) {
  if (propValue instanceof _AnimatedValue.default) {
    var listenerId = propValue.addListener(function () {});
    accumulator.push({
      propValue: propValue,
      listenerId: listenerId
    });
  } else if (Array.isArray(propValue)) {
    for (var prop of propValue) {
      addListenersToPropsValue(prop, accumulator);
    }
  } else if (propValue instanceof Object) {
    addAnimatedValuesListenersToProps(propValue, accumulator);
  }
}
function addAnimatedValuesListenersToProps(props, accumulator) {
  for (var propName in props) {
    var propValue = props[propName];
    addListenersToPropsValue(propValue, accumulator);
  }
}
function useAnimatedPropsLifecycleWithPrevNodeRef(node) {
  var prevNodeRef = (0, _react.useRef)(null);
  var isUnmountingRef = (0, _react.useRef)(false);
  (0, _react.useInsertionEffect)(function () {
    isUnmountingRef.current = false;
    return function () {
      isUnmountingRef.current = true;
    };
  }, []);
  (0, _react.useInsertionEffect)(function () {
    node.__attach();
    if (prevNodeRef.current != null) {
      var prevNode = prevNodeRef.current;
      prevNode.__restoreDefaultValues();
      prevNode.__detach();
      prevNodeRef.current = null;
    }
    return function () {
      if (isUnmountingRef.current) {
        node.__detach();
      } else {
        prevNodeRef.current = node;
      }
    };
  }, [node]);
}
function useAnimatedPropsLifecycleWithCleanupInMicrotask(node) {
  var isMounted = (0, _react.useRef)(false);
  (0, _react.useInsertionEffect)(function () {
    isMounted.current = true;
    node.__attach();
    return function () {
      isMounted.current = false;
      queueMicrotask(function () {
        if (isMounted.current) {
          node.__restoreDefaultValues();
        }
        node.__detach();
      });
    };
  }, [node]);
}
function getEventTarget(instance) {
  return typeof instance === 'object' && typeof (instance == null ? void 0 : instance.getScrollableNode) === 'function' ? instance.getScrollableNode() : instance;
}
function isFabricInstance(instance) {
  var _instance$getScrollRe;
  return (0, _ReactFabricPublicInstanceUtils.isPublicInstance)(instance) || (0, _ReactFabricPublicInstanceUtils.isPublicInstance)(instance == null || instance.getNativeScrollRef == null ? void 0 : instance.getNativeScrollRef()) || (0, _ReactFabricPublicInstanceUtils.isPublicInstance)(instance == null || instance.getScrollResponder == null || (_instance$getScrollRe = instance.getScrollResponder()) == null || _instance$getScrollRe.getNativeScrollRef == null ? void 0 : _instance$getScrollRe.getNativeScrollRef());
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfQW5pbWF0ZWRFdmVudCIsInJlcXVpcmUiLCJfQW5pbWF0ZWROb2RlIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsIl9BbmltYXRlZFByb3BzIiwiX0FuaW1hdGVkVmFsdWUiLCJfUmVhY3RGYWJyaWNQdWJsaWNJbnN0YW5jZVV0aWxzIiwiX3VzZVJlZkVmZmVjdCIsIlJlYWN0TmF0aXZlRmVhdHVyZUZsYWdzIiwiX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQiLCJfY3JlYXRlQW5pbWF0ZWRQcm9wc01lbW9Ib29rIiwiX05hdGl2ZUFuaW1hdGVkSGVscGVyIiwiX3JlYWN0IiwiZSIsInQiLCJXZWFrTWFwIiwiciIsIm4iLCJfX2VzTW9kdWxlIiwibyIsImkiLCJmIiwiX19wcm90b19fIiwiZGVmYXVsdCIsImhhcyIsImdldCIsInNldCIsIl90IiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IiLCJjcmVhdGVBbmltYXRlZFByb3BzSG9vayIsImFsbG93bGlzdCIsInVzZUFuaW1hdGVkUHJvcHNNZW1vIiwiY3JlYXRlQW5pbWF0ZWRQcm9wc01lbW9Ib29rIiwidXNlQW5pbWF0ZWRQcm9wcyIsInByb3BzIiwiX3VzZVJlZHVjZXIiLCJ1c2VSZWR1Y2VyIiwiY291bnQiLCJfdXNlUmVkdWNlcjIiLCJfc2xpY2VkVG9BcnJheTIiLCJzY2hlZHVsZVVwZGF0ZSIsIm9uVXBkYXRlUmVmIiwidXNlUmVmIiwidGltZXJSZWYiLCJub2RlIiwiQW5pbWF0ZWRQcm9wcyIsImN1cnJlbnQiLCJ1c2VOYXRpdmVQcm9wc0luRmFicmljIiwic2hvdWxkVXNlU2V0TmF0aXZlUHJvcHNJbkZhYnJpYyIsInVzZUVmZmVjdCIsIk5hdGl2ZUFuaW1hdGVkSGVscGVyIiwiQVBJIiwiZmx1c2hRdWV1ZSIsImRyaXZlbkFuaW1hdGlvbkVuZGVkTGlzdGVuZXIiLCJfX2lzTmF0aXZlIiwibmF0aXZlRXZlbnRFbWl0dGVyIiwiYWRkTGlzdGVuZXIiLCJkYXRhIiwidXBkYXRlIiwiX2RyaXZlbkFuaW1hdGlvbkVuZGVkIiwicmVtb3ZlIiwidXNlQW5pbWF0ZWRQcm9wc0xpZmVjeWNsZSIsInNjaGVkdWxlQW5pbWF0ZWRDbGVhbnVwSW5NaWNyb3Rhc2siLCJ1c2VBbmltYXRlZFByb3BzTGlmZWN5Y2xlV2l0aENsZWFudXBJbk1pY3JvdGFzayIsInVzZUFuaW1hdGVkUHJvcHNMaWZlY3ljbGVXaXRoUHJldk5vZGVSZWYiLCJyZWZFZmZlY3QiLCJ1c2VDYWxsYmFjayIsImluc3RhbmNlIiwic2V0TmF0aXZlVmlldyIsInByb2Nlc3MiLCJlbnYiLCJOT0RFX0VOViIsImlzRmFicmljTm9kZSIsImlzRmFicmljSW5zdGFuY2UiLCJzZXROYXRpdmVQcm9wcyIsIl9fZ2V0QW5pbWF0ZWRWYWx1ZSIsImNsZWFyVGltZW91dCIsInNldFRpbWVvdXQiLCJ0YXJnZXQiLCJnZXRFdmVudFRhcmdldCIsImV2ZW50cyIsImFuaW1hdGVkVmFsdWVMaXN0ZW5lcnMiLCJwcm9wTmFtZSIsInByb3BWYWx1ZSIsIkFuaW1hdGVkRXZlbnQiLCJfX2F0dGFjaCIsInB1c2giLCJhZGRMaXN0ZW5lcnNUb1Byb3BzVmFsdWUiLCJfcmVmIiwiX3JlZjIiLCJfX2RldGFjaCIsIl9yZWYzIiwibGlzdGVuZXJJZCIsInJlbW92ZUxpc3RlbmVyIiwiY2FsbGJhY2tSZWYiLCJ1c2VSZWZFZmZlY3QiLCJyZWR1Y2VBbmltYXRlZFByb3BzIiwiYXNzaWduIiwiX19nZXRWYWx1ZVdpdGhTdGF0aWNQcm9wcyIsImNvbGxhcHNhYmxlIiwiYWNjdW11bGF0b3IiLCJBbmltYXRlZFZhbHVlIiwiQXJyYXkiLCJpc0FycmF5IiwicHJvcCIsImFkZEFuaW1hdGVkVmFsdWVzTGlzdGVuZXJzVG9Qcm9wcyIsInByZXZOb2RlUmVmIiwiaXNVbm1vdW50aW5nUmVmIiwidXNlSW5zZXJ0aW9uRWZmZWN0IiwicHJldk5vZGUiLCJfX3Jlc3RvcmVEZWZhdWx0VmFsdWVzIiwiaXNNb3VudGVkIiwicXVldWVNaWNyb3Rhc2siLCJnZXRTY3JvbGxhYmxlTm9kZSIsIl9pbnN0YW5jZSRnZXRTY3JvbGxSZSIsImlzRmFicmljUHVibGljSW5zdGFuY2UiLCJnZXROYXRpdmVTY3JvbGxSZWYiLCJnZXRTY3JvbGxSZXNwb25kZXIiXSwic291cmNlcyI6WyJjcmVhdGVBbmltYXRlZFByb3BzSG9vay5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENvcHlyaWdodCAoYykgTWV0YSBQbGF0Zm9ybXMsIEluYy4gYW5kIGFmZmlsaWF0ZXMuXG4gKlxuICogVGhpcyBzb3VyY2UgY29kZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UgZm91bmQgaW4gdGhlXG4gKiBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuXG4gKlxuICogQGZsb3cgc3RyaWN0LWxvY2FsXG4gKiBAZm9ybWF0XG4gKi9cblxuaW1wb3J0IHR5cGUge0FuaW1hdGVkUHJvcHNBbGxvd2xpc3R9IGZyb20gJy4uLy4uLy4uL0xpYnJhcmllcy9BbmltYXRlZC9ub2Rlcy9BbmltYXRlZFByb3BzJztcbmltcG9ydCB0eXBlIHtFdmVudFN1YnNjcmlwdGlvbn0gZnJvbSAnLi4vLi4vLi4vTGlicmFyaWVzL0V2ZW50RW1pdHRlci9OYXRpdmVFdmVudEVtaXR0ZXInO1xuXG5pbXBvcnQge0FuaW1hdGVkRXZlbnR9IGZyb20gJy4uLy4uLy4uL0xpYnJhcmllcy9BbmltYXRlZC9BbmltYXRlZEV2ZW50JztcbmltcG9ydCBBbmltYXRlZE5vZGUgZnJvbSAnLi4vLi4vLi4vTGlicmFyaWVzL0FuaW1hdGVkL25vZGVzL0FuaW1hdGVkTm9kZSc7XG5pbXBvcnQgQW5pbWF0ZWRQcm9wcyBmcm9tICcuLi8uLi8uLi9MaWJyYXJpZXMvQW5pbWF0ZWQvbm9kZXMvQW5pbWF0ZWRQcm9wcyc7XG5pbXBvcnQgQW5pbWF0ZWRWYWx1ZSBmcm9tICcuLi8uLi8uLi9MaWJyYXJpZXMvQW5pbWF0ZWQvbm9kZXMvQW5pbWF0ZWRWYWx1ZSc7XG5pbXBvcnQge2lzUHVibGljSW5zdGFuY2UgYXMgaXNGYWJyaWNQdWJsaWNJbnN0YW5jZX0gZnJvbSAnLi4vLi4vLi4vTGlicmFyaWVzL1JlYWN0TmF0aXZlL1JlYWN0RmFicmljUHVibGljSW5zdGFuY2UvUmVhY3RGYWJyaWNQdWJsaWNJbnN0YW5jZVV0aWxzJztcbmltcG9ydCB1c2VSZWZFZmZlY3QgZnJvbSAnLi4vLi4vLi4vTGlicmFyaWVzL1V0aWxpdGllcy91c2VSZWZFZmZlY3QnO1xuaW1wb3J0ICogYXMgUmVhY3ROYXRpdmVGZWF0dXJlRmxhZ3MgZnJvbSAnLi4vZmVhdHVyZWZsYWdzL1JlYWN0TmF0aXZlRmVhdHVyZUZsYWdzJztcbmltcG9ydCB7Y3JlYXRlQW5pbWF0ZWRQcm9wc01lbW9Ib29rfSBmcm9tICcuL2NyZWF0ZUFuaW1hdGVkUHJvcHNNZW1vSG9vayc7XG5pbXBvcnQgTmF0aXZlQW5pbWF0ZWRIZWxwZXIgZnJvbSAnLi9OYXRpdmVBbmltYXRlZEhlbHBlcic7XG5pbXBvcnQge1xuICB1c2VDYWxsYmFjayxcbiAgdXNlRWZmZWN0LFxuICB1c2VJbnNlcnRpb25FZmZlY3QsXG4gIHVzZVJlZHVjZXIsXG4gIHVzZVJlZixcbn0gZnJvbSAncmVhY3QnO1xuXG50eXBlIFJlZHVjZWRQcm9wczxUUHJvcHM+ID0ge1xuICAuLi5UUHJvcHMsXG4gIGNvbGxhcHNhYmxlOiBib29sZWFuLFxuICAuLi5cbn07XG50eXBlIENhbGxiYWNrUmVmPFQ+ID0gVCA9PiBtaXhlZDtcblxuZXhwb3J0IHR5cGUgQW5pbWF0ZWRQcm9wc0hvb2sgPSA8VFByb3BzOiB7Li4ufSwgVEluc3RhbmNlPihcbiAgcHJvcHM6IFRQcm9wcyxcbikgPT4gW1JlZHVjZWRQcm9wczxUUHJvcHM+LCBDYWxsYmFja1JlZjxUSW5zdGFuY2UgfCBudWxsPl07XG5cbnR5cGUgVXBkYXRlQ2FsbGJhY2sgPSAoKSA9PiB2b2lkO1xuXG50eXBlIEFuaW1hdGVkVmFsdWVMaXN0ZW5lcnMgPSBBcnJheTx7XG4gIHByb3BWYWx1ZTogQW5pbWF0ZWRWYWx1ZSxcbiAgbGlzdGVuZXJJZDogc3RyaW5nLFxufT47XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGNyZWF0ZUFuaW1hdGVkUHJvcHNIb29rKFxuICBhbGxvd2xpc3Q6ID9BbmltYXRlZFByb3BzQWxsb3dsaXN0LFxuKTogQW5pbWF0ZWRQcm9wc0hvb2sge1xuICBjb25zdCB1c2VBbmltYXRlZFByb3BzTWVtbyA9IGNyZWF0ZUFuaW1hdGVkUHJvcHNNZW1vSG9vayhhbGxvd2xpc3QpO1xuXG4gIHJldHVybiBmdW5jdGlvbiB1c2VBbmltYXRlZFByb3BzPFRQcm9wczogey4uLn0sIFRJbnN0YW5jZT4oXG4gICAgcHJvcHM6IFRQcm9wcyxcbiAgKTogW1JlZHVjZWRQcm9wczxUUHJvcHM+LCBDYWxsYmFja1JlZjxUSW5zdGFuY2UgfCBudWxsPl0ge1xuICAgIGNvbnN0IFssIHNjaGVkdWxlVXBkYXRlXSA9IHVzZVJlZHVjZXI8bnVtYmVyLCB2b2lkPihjb3VudCA9PiBjb3VudCArIDEsIDApO1xuICAgIGNvbnN0IG9uVXBkYXRlUmVmID0gdXNlUmVmPFVwZGF0ZUNhbGxiYWNrIHwgbnVsbD4obnVsbCk7XG4gICAgY29uc3QgdGltZXJSZWYgPSB1c2VSZWY8VGltZW91dElEIHwgbnVsbD4obnVsbCk7XG5cbiAgICBjb25zdCBub2RlID0gdXNlQW5pbWF0ZWRQcm9wc01lbW8oXG4gICAgICAoKSA9PiBuZXcgQW5pbWF0ZWRQcm9wcyhwcm9wcywgKCkgPT4gb25VcGRhdGVSZWYuY3VycmVudD8uKCksIGFsbG93bGlzdCksXG4gICAgICBwcm9wcyxcbiAgICApO1xuXG4gICAgY29uc3QgdXNlTmF0aXZlUHJvcHNJbkZhYnJpYyA9XG4gICAgICBSZWFjdE5hdGl2ZUZlYXR1cmVGbGFncy5zaG91bGRVc2VTZXROYXRpdmVQcm9wc0luRmFicmljKCk7XG5cbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgLy8gSWYgbXVsdGlwbGUgY29tcG9uZW50cyBjYWxsIGBmbHVzaFF1ZXVlYCwgdGhlIGZpcnN0IG9uZSB3aWxsIGZsdXNoIHRoZVxuICAgICAgLy8gcXVldWUgYW5kIHN1YnNlcXVlbnQgb25lcyB3aWxsIGRvIG5vdGhpbmcuXG4gICAgICBOYXRpdmVBbmltYXRlZEhlbHBlci5BUEkuZmx1c2hRdWV1ZSgpO1xuICAgICAgbGV0IGRyaXZlbkFuaW1hdGlvbkVuZGVkTGlzdGVuZXI6ID9FdmVudFN1YnNjcmlwdGlvbiA9IG51bGw7XG4gICAgICBpZiAobm9kZS5fX2lzTmF0aXZlKSB7XG4gICAgICAgIGRyaXZlbkFuaW1hdGlvbkVuZGVkTGlzdGVuZXIgPVxuICAgICAgICAgIE5hdGl2ZUFuaW1hdGVkSGVscGVyLm5hdGl2ZUV2ZW50RW1pdHRlci5hZGRMaXN0ZW5lcihcbiAgICAgICAgICAgICdvblVzZXJEcml2ZW5BbmltYXRpb25FbmRlZCcsXG4gICAgICAgICAgICBkYXRhID0+IHtcbiAgICAgICAgICAgICAgbm9kZS51cGRhdGUoKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuICgpID0+IHtcbiAgICAgICAgZHJpdmVuQW5pbWF0aW9uRW5kZWRMaXN0ZW5lcj8ucmVtb3ZlKCk7XG4gICAgICB9O1xuICAgIH0pO1xuXG4gICAgLy8gTk9URTogVGhpcyBmZWF0dXJlIGZsYWcgbXVzdCBiZSBldmFsdWF0ZWQgaW5zaWRlIHRoZSBob29rIGJlY2F1c2UgdGhpc1xuICAgIC8vIG1vZHVsZSBmYWN0b3J5IGNhbiBiZSBldmFsdWF0ZWQgbXVjaCBzb29uZXIsIGJlZm9yZSBvdmVycmlkZXMgYXJlIHNldC5cbiAgICBjb25zdCB1c2VBbmltYXRlZFByb3BzTGlmZWN5Y2xlID1cbiAgICAgIFJlYWN0TmF0aXZlRmVhdHVyZUZsYWdzLnNjaGVkdWxlQW5pbWF0ZWRDbGVhbnVwSW5NaWNyb3Rhc2soKVxuICAgICAgICA/IHVzZUFuaW1hdGVkUHJvcHNMaWZlY3ljbGVXaXRoQ2xlYW51cEluTWljcm90YXNrXG4gICAgICAgIDogdXNlQW5pbWF0ZWRQcm9wc0xpZmVjeWNsZVdpdGhQcmV2Tm9kZVJlZjtcblxuICAgIHVzZUFuaW1hdGVkUHJvcHNMaWZlY3ljbGUobm9kZSk7XG5cbiAgICAvLyBUT0RPOiBUaGlzIFwiZWZmZWN0XCIgZG9lcyB0aHJlZSB0aGluZ3M6XG4gICAgLy9cbiAgICAvLyAgIDEpIENhbGwgYHNldE5hdGl2ZVZpZXdgLlxuICAgIC8vICAgMikgVXBkYXRlIGBvblVwZGF0ZVJlZmAuXG4gICAgLy8gICAzKSBVcGRhdGUgbGlzdGVuZXJzIGZvciBgQW5pbWF0ZWRFdmVudGAgcHJvcHMuXG4gICAgLy9cbiAgICAvLyBJZGVhbGx5LCBlYWNoIG9mIHRoZXNlIHdvdWxkIGJlIHNlcGFyYXRlIFwiZWZmZWN0c1wiIHNvIHRoYXQgdGhleSBhcmUgbm90XG4gICAgLy8gdW5uZWNlc3NhcmlseSByZS1ydW4gd2hlbiBpcnJlbGV2YW50IGRlcGVuZGVuY2llcyBjaGFuZ2UuIEZvciBleGFtcGxlLCB3ZVxuICAgIC8vIHNob3VsZCBiZSBhYmxlIHRvIGhvaXN0IGFsbCBgQW5pbWF0ZWRFdmVudGAgcHJvcHMgYW5kIG9ubHkgZG8gIzMgaWYgZWl0aGVyXG4gICAgLy8gdGhlIGBBbmltYXRlZEV2ZW50YCBwcm9wcyBjaGFuZ2Ugb3IgYGluc3RhbmNlYCBjaGFuZ2VzLlxuICAgIC8vXG4gICAgLy8gQnV0IHRoZXJlIGlzIG5vIHdheSB0byB0cmFuc3BhcmVudGx5IGNvbXBvc2UgdGhyZWUgc2VwYXJhdGUgY2FsbGJhY2sgcmVmcyxcbiAgICAvLyBzbyB3ZSBqdXN0IGNvbWJpbmUgdGhlbSBhbGwgaW50byBvbmUgZm9yIG5vdy5cbiAgICBjb25zdCByZWZFZmZlY3QgPSB1c2VDYWxsYmFjayhcbiAgICAgIChpbnN0YW5jZTogVEluc3RhbmNlKSA9PiB7XG4gICAgICAgIC8vIE5PVEU6IFRoaXMgbWF5IGJlIGNhbGxlZCBtb3JlIG9mdGVuIHRoYW4gbmVjZXNzYXJ5IChlLmcuIHdoZW4gYHByb3BzYFxuICAgICAgICAvLyBjaGFuZ2VzKSwgYnV0IGBzZXROYXRpdmVWaWV3YCBhbHJlYWR5IG9wdGltaXplcyBmb3IgdGhhdC5cbiAgICAgICAgbm9kZS5zZXROYXRpdmVWaWV3KGluc3RhbmNlKTtcblxuICAgICAgICAvLyBOT1RFOiBXaGVuIHVzaW5nIHRoZSBKUyBhbmltYXRpb24gZHJpdmVyLCB0aGlzIGNhbGxiYWNrIGlzIGNhbGxlZCBvblxuICAgICAgICAvLyBldmVyeSBhbmltYXRpb24gZnJhbWUuIFdoZW4gdXNpbmcgdGhlIG5hdGl2ZSBkcml2ZXIsIHRoaXMgY2FsbGJhY2sgaXNcbiAgICAgICAgLy8gY2FsbGVkIHdoZW4gdGhlIGFuaW1hdGlvbiBjb21wbGV0ZXMuXG4gICAgICAgIG9uVXBkYXRlUmVmLmN1cnJlbnQgPSAoKSA9PiB7XG4gICAgICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAndGVzdCcpIHtcbiAgICAgICAgICAgIC8vIENoZWNrIDE6IHRoaXMgaXMgYSB0ZXN0LlxuICAgICAgICAgICAgLy8gY2FsbCBgc2NoZWR1bGVVcGRhdGVgIHRvIGJ5cGFzcyB1c2Ugb2Ygc2V0TmF0aXZlUHJvcHMuXG4gICAgICAgICAgICByZXR1cm4gc2NoZWR1bGVVcGRhdGUoKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBjb25zdCBpc0ZhYnJpY05vZGUgPSBpc0ZhYnJpY0luc3RhbmNlKGluc3RhbmNlKTtcbiAgICAgICAgICBpZiAobm9kZS5fX2lzTmF0aXZlKSB7XG4gICAgICAgICAgICAvLyBDaGVjayAyOiB0aGlzIGlzIGFuIGFuaW1hdGlvbiBkcml2ZW4gYnkgbmF0aXZlLlxuICAgICAgICAgICAgLy8gSW4gbmF0aXZlIGRyaXZlbiBhbmltYXRpb25zLCB0aGlzIGNhbGxiYWNrIGlzIG9ubHkgY2FsbGVkIG9uY2UgdGhlIGFuaW1hdGlvbiBjb21wbGV0ZXMuXG4gICAgICAgICAgICBpZiAoaXNGYWJyaWNOb2RlKSB7XG4gICAgICAgICAgICAgIC8vIENhbGwgYHNjaGVkdWxlVXBkYXRlYCB0byBzeW5jaHJvbmlzZSBGaWJlciBhbmQgU2hhZG93IHRyZWUuXG4gICAgICAgICAgICAgIC8vIE11c3Qgbm90IGJlIGNhbGxlZCBpbiBQYXBlci5cbiAgICAgICAgICAgICAgc2NoZWR1bGVVcGRhdGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAoXG4gICAgICAgICAgICB0eXBlb2YgaW5zdGFuY2UgIT09ICdvYmplY3QnIHx8XG4gICAgICAgICAgICB0eXBlb2YgaW5zdGFuY2U/LnNldE5hdGl2ZVByb3BzICE9PSAnZnVuY3Rpb24nXG4gICAgICAgICAgKSB7XG4gICAgICAgICAgICAvLyBDaGVjayAzOiB0aGUgaW5zdGFuY2UgZG9lcyBub3Qgc3VwcG9ydCBzZXROYXRpdmVQcm9wcy4gQ2FsbCBgc2NoZWR1bGVVcGRhdGVgLlxuICAgICAgICAgICAgcmV0dXJuIHNjaGVkdWxlVXBkYXRlKCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKCFpc0ZhYnJpY05vZGUpIHtcbiAgICAgICAgICAgIC8vIENoZWNrIDQ6IHRoaXMgaXMgYSBwYXBlciBpbnN0YW5jZSwgY2FsbCBzZXROYXRpdmVQcm9wcy5cbiAgICAgICAgICAgIC8vICRGbG93SWdub3JlW25vdC1hLWZ1bmN0aW9uXSAtIEFzc3VtZSBpdCdzIHN0aWxsIGEgZnVuY3Rpb24uXG4gICAgICAgICAgICAvLyAkRmxvd0ZpeE1lW2luY29tcGF0aWJsZS11c2VdXG4gICAgICAgICAgICByZXR1cm4gaW5zdGFuY2Uuc2V0TmF0aXZlUHJvcHMobm9kZS5fX2dldEFuaW1hdGVkVmFsdWUoKSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKCF1c2VOYXRpdmVQcm9wc0luRmFicmljKSB7XG4gICAgICAgICAgICAvLyBDaGVjayA1OiBzZXROYXRpdmVQcm9wcyBhcmUgZGlzYWJsZWQuXG4gICAgICAgICAgICByZXR1cm4gc2NoZWR1bGVVcGRhdGUoKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyBUaGlzIGlzIGEgRmFicmljIGluc3RhbmNlIGFuZCBzZXROYXRpdmVQcm9wcyBpcyBzdXBwb3J0ZWQuXG5cbiAgICAgICAgICAvLyAkRmxvd0lnbm9yZVtub3QtYS1mdW5jdGlvbl0gLSBBc3N1bWUgaXQncyBzdGlsbCBhIGZ1bmN0aW9uLlxuICAgICAgICAgIC8vICRGbG93Rml4TWVbaW5jb21wYXRpYmxlLXVzZV1cbiAgICAgICAgICBpbnN0YW5jZS5zZXROYXRpdmVQcm9wcyhub2RlLl9fZ2V0QW5pbWF0ZWRWYWx1ZSgpKTtcblxuICAgICAgICAgIC8vIEtlZXBpbmcgc3RhdGUgb2YgRmliZXIgdHJlZSBhbmQgU2hhZG93IHRyZWUgaW4gc3luYy5cbiAgICAgICAgICAvL1xuICAgICAgICAgIC8vIFRoaXMgaXMgZG9uZSBieSBjYWxsaW5nIGBzY2hlZHVsZVVwZGF0ZWAgd2hpY2ggd2lsbCB0cmlnZ2VyIGEgY29tbWl0LlxuICAgICAgICAgIC8vIEhvd2V2ZXIsIFJlYWN0IGNvbW1pdCBpcyBub3QgZmFzdCBlbm91Z2ggdG8gZHJpdmUgYW5pbWF0aW9ucy5cbiAgICAgICAgICAvLyBUaGlzIGlzIHdoZXJlIHNldE5hdGl2ZVByb3BzIGNvbWVzIGluIGhhbmR5IGJ1dCB0aGUgc3RhdGUgYmV0d2VlblxuICAgICAgICAgIC8vIEZpYmVyIHRyZWUgYW5kIFNoYWRvdyB0cmVlIG5lZWRzIHRvIGJlIGtlcHQgaW4gc3luYy5cbiAgICAgICAgICAvLyBUaGUgZ29hbCBpcyB0byBjYWxsIGBzY2hlZHVsZVVwZGF0ZWAgYXMgbGl0dGxlIGFzIHBvc3NpYmxlIHRvIG1haW50YWluXG4gICAgICAgICAgLy8gcGVyZm9ybWFuY2UgYnV0IGZyZXF1ZW50bHkgZW5vdWdoIHRvIGtlZXAgc3RhdGUgaW4gc3luYy5cbiAgICAgICAgICAvLyBEZWJvdW5jZSBpcyBzZXQgdG8gNDhtcywgd2hpY2ggaXMgMyAqIHRoZSBkdXJhdGlvbiBvZiBhIGZyYW1lLlxuICAgICAgICAgIC8vIDMgZnJhbWVzIHdhcyB0aGUgaGlnaGVzdCB2YWx1ZSB3aGVyZSBmbGlja2VyaW5nIHN0YXRlIHdhcyBub3Qgb2JzZXJ2ZWQuXG4gICAgICAgICAgaWYgKHRpbWVyUmVmLmN1cnJlbnQgIT0gbnVsbCkge1xuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVyUmVmLmN1cnJlbnQpO1xuICAgICAgICAgIH1cbiAgICAgICAgICB0aW1lclJlZi5jdXJyZW50ID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICB0aW1lclJlZi5jdXJyZW50ID0gbnVsbDtcbiAgICAgICAgICAgIHNjaGVkdWxlVXBkYXRlKCk7XG4gICAgICAgICAgfSwgNDgpO1xuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnN0IHRhcmdldCA9IGdldEV2ZW50VGFyZ2V0KGluc3RhbmNlKTtcbiAgICAgICAgY29uc3QgZXZlbnRzID0gW107XG4gICAgICAgIGNvbnN0IGFuaW1hdGVkVmFsdWVMaXN0ZW5lcnM6IEFuaW1hdGVkVmFsdWVMaXN0ZW5lcnMgPSBbXTtcblxuICAgICAgICBmb3IgKGNvbnN0IHByb3BOYW1lIGluIHByb3BzKSB7XG4gICAgICAgICAgLy8gJEZsb3dGaXhNZVtpbnZhbGlkLWNvbXB1dGVkLXByb3BdXG4gICAgICAgICAgY29uc3QgcHJvcFZhbHVlID0gcHJvcHNbcHJvcE5hbWVdO1xuICAgICAgICAgIGlmIChwcm9wVmFsdWUgaW5zdGFuY2VvZiBBbmltYXRlZEV2ZW50ICYmIHByb3BWYWx1ZS5fX2lzTmF0aXZlKSB7XG4gICAgICAgICAgICBwcm9wVmFsdWUuX19hdHRhY2godGFyZ2V0LCBwcm9wTmFtZSk7XG4gICAgICAgICAgICBldmVudHMucHVzaChbcHJvcE5hbWUsIHByb3BWYWx1ZV0pO1xuICAgICAgICAgICAgLy8gJEZsb3dGaXhNZVtpbmNvbXBhdGlibGUtY2FsbF0gLSB0aGUgYGFkZExpc3RlbmVyc1RvUHJvcHNWYWx1ZWAgZHJpbGxzIGRvd24gdGhlIHByb3BWYWx1ZS5cbiAgICAgICAgICAgIGFkZExpc3RlbmVyc1RvUHJvcHNWYWx1ZShwcm9wVmFsdWUsIGFuaW1hdGVkVmFsdWVMaXN0ZW5lcnMpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgICAgb25VcGRhdGVSZWYuY3VycmVudCA9IG51bGw7XG5cbiAgICAgICAgICBmb3IgKGNvbnN0IFtwcm9wTmFtZSwgcHJvcFZhbHVlXSBvZiBldmVudHMpIHtcbiAgICAgICAgICAgIHByb3BWYWx1ZS5fX2RldGFjaCh0YXJnZXQsIHByb3BOYW1lKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBmb3IgKGNvbnN0IHtwcm9wVmFsdWUsIGxpc3RlbmVySWR9IG9mIGFuaW1hdGVkVmFsdWVMaXN0ZW5lcnMpIHtcbiAgICAgICAgICAgIHByb3BWYWx1ZS5yZW1vdmVMaXN0ZW5lcihsaXN0ZW5lcklkKTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICB9LFxuICAgICAgW25vZGUsIHVzZU5hdGl2ZVByb3BzSW5GYWJyaWMsIHByb3BzXSxcbiAgICApO1xuICAgIGNvbnN0IGNhbGxiYWNrUmVmID0gdXNlUmVmRWZmZWN0PFRJbnN0YW5jZT4ocmVmRWZmZWN0KTtcblxuICAgIHJldHVybiBbcmVkdWNlQW5pbWF0ZWRQcm9wczxUUHJvcHM+KG5vZGUsIHByb3BzKSwgY2FsbGJhY2tSZWZdO1xuICB9O1xufVxuXG5mdW5jdGlvbiByZWR1Y2VBbmltYXRlZFByb3BzPFRQcm9wcz4oXG4gIG5vZGU6IEFuaW1hdGVkUHJvcHMsXG4gIHByb3BzOiBUUHJvcHMsXG4pOiBSZWR1Y2VkUHJvcHM8VFByb3BzPiB7XG4gIC8vIEZvcmNlIGBjb2xsYXBzYWJsZWAgdG8gYmUgZmFsc2Ugc28gdGhhdCB0aGUgbmF0aXZlIHZpZXcgaXMgbm90IGZsYXR0ZW5lZC5cbiAgLy8gRmxhdHRlbmVkIHZpZXdzIGNhbm5vdCBiZSBhY2N1cmF0ZWx5IHJlZmVyZW5jZWQgYnkgdGhlIG5hdGl2ZSBkcml2ZXIuXG4gIHJldHVybiB7XG4gICAgLi4ubm9kZS5fX2dldFZhbHVlV2l0aFN0YXRpY1Byb3BzKHByb3BzKSxcbiAgICBjb2xsYXBzYWJsZTogZmFsc2UsXG4gIH07XG59XG5cbmZ1bmN0aW9uIGFkZExpc3RlbmVyc1RvUHJvcHNWYWx1ZShcbiAgcHJvcFZhbHVlOiBBbmltYXRlZFZhbHVlLFxuICBhY2N1bXVsYXRvcjogQW5pbWF0ZWRWYWx1ZUxpc3RlbmVycyxcbikge1xuICAvLyBwcm9wVmFsdWUgY2FuIGJlIGEgc2NhbGFyIHZhbHVlLCBhbiBhcnJheSBvciBhbiBvYmplY3QuXG4gIGlmIChwcm9wVmFsdWUgaW5zdGFuY2VvZiBBbmltYXRlZFZhbHVlKSB7XG4gICAgY29uc3QgbGlzdGVuZXJJZCA9IHByb3BWYWx1ZS5hZGRMaXN0ZW5lcigoKSA9PiB7fSk7XG4gICAgYWNjdW11bGF0b3IucHVzaCh7cHJvcFZhbHVlLCBsaXN0ZW5lcklkfSk7XG4gIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShwcm9wVmFsdWUpKSB7XG4gICAgLy8gQW4gYXJyYXkgY2FuIGJlIGFuIGFycmF5IG9mIHNjYWxhciB2YWx1ZXMsIGFycmF5cyBvZiBhcnJheXMsIG9yIGFycmF5cyBvZiBvYmplY3RzXG4gICAgZm9yIChjb25zdCBwcm9wIG9mIHByb3BWYWx1ZSkge1xuICAgICAgYWRkTGlzdGVuZXJzVG9Qcm9wc1ZhbHVlKHByb3AsIGFjY3VtdWxhdG9yKTtcbiAgICB9XG4gIH0gZWxzZSBpZiAocHJvcFZhbHVlIGluc3RhbmNlb2YgT2JqZWN0KSB7XG4gICAgYWRkQW5pbWF0ZWRWYWx1ZXNMaXN0ZW5lcnNUb1Byb3BzKHByb3BWYWx1ZSwgYWNjdW11bGF0b3IpO1xuICB9XG59XG5cbmZ1bmN0aW9uIGFkZEFuaW1hdGVkVmFsdWVzTGlzdGVuZXJzVG9Qcm9wcyhcbiAgcHJvcHM6IEFuaW1hdGVkTm9kZSxcbiAgYWNjdW11bGF0b3I6IEFuaW1hdGVkVmFsdWVMaXN0ZW5lcnMsXG4pIHtcbiAgZm9yIChjb25zdCBwcm9wTmFtZSBpbiBwcm9wcykge1xuICAgIC8vICRGbG93Rml4TWVbcHJvcC1taXNzaW5nXSAtIFRoaXMgaXMgYW4gb2JqZWN0IGNvbnRhaW5lZCBpbiBhIHByb3AsIGJ1dCB3ZSBkb24ndCBrbm93IHRoZSBleGFjdCB0eXBlLlxuICAgIGNvbnN0IHByb3BWYWx1ZSA9IHByb3BzW3Byb3BOYW1lXTtcbiAgICBhZGRMaXN0ZW5lcnNUb1Byb3BzVmFsdWUocHJvcFZhbHVlLCBhY2N1bXVsYXRvcik7XG4gIH1cbn1cblxuLyoqXG4gKiBNYW5hZ2VzIHRoZSBsaWZlY3ljbGUgb2YgdGhlIHN1cHBsaWVkIGBBbmltYXRlZFByb3BzYCBieSBpbnZva2luZyBgX19hdHRhY2hgXG4gKiBhbmQgYF9fZGV0YWNoYC4gSG93ZXZlciwgdGhpcyBpcyBtb3JlIGNvbXBsaWNhdGVkIGJlY2F1c2UgYEFuaW1hdGVkUHJvcHNgXG4gKiB1c2VzIHJlZmVyZW5jZSBjb3VudGluZyB0byBkZXRlcm1pbmUgd2hlbiB0byByZWN1cnNpdmVseSBkZXRhY2ggaXRzIGNoaWxkcmVuXG4gKiBub2Rlcy4gU28gaW4gb3JkZXIgdG8gb3B0aW1pemUgdGhpcywgd2UgYXZvaWQgZGV0YWNoaW5nIHVudGlsIHRoZSBuZXh0IGF0dGFjaFxuICogdW5sZXNzIHdlIGFyZSB1bm1vdW50aW5nLlxuICovXG5mdW5jdGlvbiB1c2VBbmltYXRlZFByb3BzTGlmZWN5Y2xlV2l0aFByZXZOb2RlUmVmKG5vZGU6IEFuaW1hdGVkUHJvcHMpOiB2b2lkIHtcbiAgY29uc3QgcHJldk5vZGVSZWYgPSB1c2VSZWY8P0FuaW1hdGVkUHJvcHM+KG51bGwpO1xuICBjb25zdCBpc1VubW91bnRpbmdSZWYgPSB1c2VSZWY8Ym9vbGVhbj4oZmFsc2UpO1xuXG4gIHVzZUluc2VydGlvbkVmZmVjdCgoKSA9PiB7XG4gICAgaXNVbm1vdW50aW5nUmVmLmN1cnJlbnQgPSBmYWxzZTtcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgaXNVbm1vdW50aW5nUmVmLmN1cnJlbnQgPSB0cnVlO1xuICAgIH07XG4gIH0sIFtdKTtcblxuICB1c2VJbnNlcnRpb25FZmZlY3QoKCkgPT4ge1xuICAgIG5vZGUuX19hdHRhY2goKTtcbiAgICBpZiAocHJldk5vZGVSZWYuY3VycmVudCAhPSBudWxsKSB7XG4gICAgICBjb25zdCBwcmV2Tm9kZSA9IHByZXZOb2RlUmVmLmN1cnJlbnQ7XG4gICAgICAvLyBUT0RPOiBTdG9wIHJlc3RvcmluZyBkZWZhdWx0IHZhbHVlcyAodW5sZXNzIGByZXNldGAgaXMgY2FsbGVkKS5cbiAgICAgIHByZXZOb2RlLl9fcmVzdG9yZURlZmF1bHRWYWx1ZXMoKTtcbiAgICAgIHByZXZOb2RlLl9fZGV0YWNoKCk7XG4gICAgICBwcmV2Tm9kZVJlZi5jdXJyZW50ID0gbnVsbDtcbiAgICB9XG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIGlmIChpc1VubW91bnRpbmdSZWYuY3VycmVudCkge1xuICAgICAgICAvLyBOT1RFOiBEbyBub3QgcmVzdG9yZSBkZWZhdWx0IHZhbHVlcyBvbiB1bm1vdW50LCBzZWUgRDE4MTk3NzM1LlxuICAgICAgICBub2RlLl9fZGV0YWNoKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBwcmV2Tm9kZVJlZi5jdXJyZW50ID0gbm9kZTtcbiAgICAgIH1cbiAgICB9O1xuICB9LCBbbm9kZV0pO1xufVxuXG4vKipcbiAqIE1hbmFnZXMgdGhlIGxpZmVjeWNsZSBvZiB0aGUgc3VwcGxpZWQgYEFuaW1hdGVkUHJvcHNgIGJ5IGludm9raW5nIGBfX2F0dGFjaGBcbiAqIGFuZCBgX19kZXRhY2hgLiBIb3dldmVyLCBgX19kZXRhY2hgIG9jY3VycyBpbiBhIG1pY3JvdGFzayBmb3IgdGhlc2UgcmVhc29uczpcbiAqXG4gKiAgIDEuIE9wdGltaXplcyBkZXRhY2hpbmcgYW5kIGF0dGFjaGluZyBgQW5pbWF0ZWROb2RlYCBpbnN0YW5jZXMgdGhhdCByZWx5IG9uXG4gKiAgICAgIHJlZmVyZW5jZSBjb3VudGluZyB0byBjbGVhbnVwIHN0YXRlLCBieSBjYXVzaW5nIGRldGFjaCB0byBiZSBzY2hlZHVsZWRcbiAqICAgICAgYWZ0ZXIgYW55IHN1YnNlcXVlbnQgYXR0YWNoLlxuICogICAyLiBBdm9pZHMgY2FsbGluZyBgZGV0YWNoYCBkdXJpbmcgdGhlIGluc2VydGlvbiBlZmZlY3QgcGhhc2UgKHdoaWNoXG4gKiAgICAgIG9jY3VycyBkdXJpbmcgdGhlIGNvbW1pdCBwaGFzZSksIHdoaWNoIG1heSBpbnZva2UgY29tcGxldGlvbiBjYWxsYmFja3MuXG4gKlxuICogV2Ugc2hvdWxkIGF2b2lkIGludm9raW5nIGNvbXBsZXRpb24gY2FsbGJhY2tzIGR1cmluZyB0aGUgY29tbWl0IHBoYXNlIGJlY2F1c2VcbiAqIGNhbGxiYWNrcyBtYXkgdXBkYXRlIHN0YXRlLCB3aGljaCBpcyB1bnN1cHBvcnRlZCBhbmQgd2lsbCBmb3JjZSBzeW5jaHJvbm91c1xuICogdXBkYXRlcy5cbiAqL1xuZnVuY3Rpb24gdXNlQW5pbWF0ZWRQcm9wc0xpZmVjeWNsZVdpdGhDbGVhbnVwSW5NaWNyb3Rhc2soXG4gIG5vZGU6IEFuaW1hdGVkUHJvcHMsXG4pOiB2b2lkIHtcbiAgY29uc3QgaXNNb3VudGVkID0gdXNlUmVmPGJvb2xlYW4+KGZhbHNlKTtcblxuICB1c2VJbnNlcnRpb25FZmZlY3QoKCkgPT4ge1xuICAgIGlzTW91bnRlZC5jdXJyZW50ID0gdHJ1ZTtcbiAgICBub2RlLl9fYXR0YWNoKCk7XG5cbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgaXNNb3VudGVkLmN1cnJlbnQgPSBmYWxzZTtcbiAgICAgIHF1ZXVlTWljcm90YXNrKCgpID0+IHtcbiAgICAgICAgLy8gTk9URTogRG8gbm90IHJlc3RvcmUgZGVmYXVsdCB2YWx1ZXMgb24gdW5tb3VudCwgc2VlIEQxODE5NzczNS5cbiAgICAgICAgaWYgKGlzTW91bnRlZC5jdXJyZW50KSB7XG4gICAgICAgICAgLy8gVE9ETzogU3RvcCByZXN0b3JpbmcgZGVmYXVsdCB2YWx1ZXMgKHVubGVzcyBgcmVzZXRgIGlzIGNhbGxlZCkuXG4gICAgICAgICAgbm9kZS5fX3Jlc3RvcmVEZWZhdWx0VmFsdWVzKCk7XG4gICAgICAgIH1cbiAgICAgICAgbm9kZS5fX2RldGFjaCgpO1xuICAgICAgfSk7XG4gICAgfTtcbiAgfSwgW25vZGVdKTtcbn1cblxuZnVuY3Rpb24gZ2V0RXZlbnRUYXJnZXQ8VEluc3RhbmNlPihpbnN0YW5jZTogVEluc3RhbmNlKTogVEluc3RhbmNlIHtcbiAgcmV0dXJuIHR5cGVvZiBpbnN0YW5jZSA9PT0gJ29iamVjdCcgJiZcbiAgICB0eXBlb2YgaW5zdGFuY2U/LmdldFNjcm9sbGFibGVOb2RlID09PSAnZnVuY3Rpb24nXG4gICAgPyAvLyAkRmxvd0ZpeE1lW2luY29tcGF0aWJsZS11c2VdIC0gTGVnYWN5IGluc3RhbmNlIGFzc3VtcHRpb25zLlxuICAgICAgaW5zdGFuY2UuZ2V0U2Nyb2xsYWJsZU5vZGUoKVxuICAgIDogaW5zdGFuY2U7XG59XG5cbi8vICRGbG93Rml4TWVbdW5jbGVhci10eXBlXSAtIExlZ2FjeSBpbnN0YW5jZSBhc3N1bXB0aW9ucy5cbmZ1bmN0aW9uIGlzRmFicmljSW5zdGFuY2UoaW5zdGFuY2U6IGFueSk6IGJvb2xlYW4ge1xuICByZXR1cm4gKFxuICAgIGlzRmFicmljUHVibGljSW5zdGFuY2UoaW5zdGFuY2UpIHx8XG4gICAgLy8gU29tZSBjb21wb25lbnRzIGhhdmUgYSBzZXROYXRpdmVQcm9wcyBmdW5jdGlvbiBidXQgYXJlbid0IGEgaG9zdCBjb21wb25lbnRcbiAgICAvLyBzdWNoIGFzIGxpc3RzIGxpa2UgRmxhdExpc3QgYW5kIFNlY3Rpb25MaXN0LiBUaGVzZSBzaG91bGQgYWxzbyB1c2VcbiAgICAvLyBmb3JjZVVwZGF0ZSBpbiBGYWJyaWMgc2luY2Ugc2V0TmF0aXZlUHJvcHMgZG9lc24ndCBleGlzdCBvbiB0aGUgdW5kZXJseWluZ1xuICAgIC8vIGhvc3QgY29tcG9uZW50LiBUaGlzIGNyYXp5IGhhY2sgaXMgZXNzZW50aWFsbHkgc3BlY2lhbCBjYXNpbmcgdGhvc2UgbGlzdHMgYW5kXG4gICAgLy8gU2Nyb2xsVmlldyBpdHNlbGYgdG8gdXNlIGZvcmNlVXBkYXRlIGluIEZhYnJpYy5cbiAgICAvLyBJZiB0aGVzZSBjb21wb25lbnRzIGVuZCB1cCB1c2luZyBmb3J3YXJkUmVmIHRoZW4gdGhlc2UgaGFja3MgY2FuIGdvIGF3YXlcbiAgICAvLyBhcyBpbnN0YW5jZSB3b3VsZCBhY3R1YWxseSBiZSB0aGUgdW5kZXJseWluZyBob3N0IGNvbXBvbmVudCBhbmQgdGhlIGFib3ZlIGNoZWNrXG4gICAgLy8gd291bGQgYmUgc3VmZmljaWVudC5cbiAgICBpc0ZhYnJpY1B1YmxpY0luc3RhbmNlKGluc3RhbmNlPy5nZXROYXRpdmVTY3JvbGxSZWY/LigpKSB8fFxuICAgIGlzRmFicmljUHVibGljSW5zdGFuY2UoXG4gICAgICBpbnN0YW5jZT8uZ2V0U2Nyb2xsUmVzcG9uZGVyPy4oKT8uZ2V0TmF0aXZlU2Nyb2xsUmVmPy4oKSxcbiAgICApXG4gICk7XG59XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQWFBLElBQUFBLGNBQUEsR0FBQUMsT0FBQTtBQUNBLElBQUFDLGFBQUEsR0FBQUMsc0JBQUEsQ0FBQUYsT0FBQTtBQUNBLElBQUFHLGNBQUEsR0FBQUQsc0JBQUEsQ0FBQUYsT0FBQTtBQUNBLElBQUFJLGNBQUEsR0FBQUYsc0JBQUEsQ0FBQUYsT0FBQTtBQUNBLElBQUFLLCtCQUFBLEdBQUFMLE9BQUE7QUFDQSxJQUFBTSxhQUFBLEdBQUFKLHNCQUFBLENBQUFGLE9BQUE7QUFDQSxJQUFBTyx1QkFBQSxHQUFBQyx1QkFBQSxDQUFBUixPQUFBO0FBQ0EsSUFBQVMsNEJBQUEsR0FBQVQsT0FBQTtBQUNBLElBQUFVLHFCQUFBLEdBQUFSLHNCQUFBLENBQUFGLE9BQUE7QUFDQSxJQUFBVyxNQUFBLEdBQUFYLE9BQUE7QUFNZSxTQUFBUSx3QkFBQUksQ0FBQSxFQUFBQyxDQUFBLDZCQUFBQyxPQUFBLE1BQUFDLENBQUEsT0FBQUQsT0FBQSxJ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